<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ezp-next: eZ\Publish\Core\Repository\UserService Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ezp-next
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">eZ\Publish\Core\Repository\UserService Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for eZ\Publish\Core\Repository\UserService:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService__inherit__graph.png" border="0" usemap="#eZ_0CPublish_0CCore_0CRepository_0CUserService_inherit__map" alt="Inheritance graph"/></div>
<map name="eZ_0CPublish_0CCore_0CRepository_0CUserService_inherit__map" id="eZ_0CPublish_0CCore_0CRepository_0CUserService_inherit__map">
<area shape="rect" id="node2" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html" title="eZ\\Publish\\API\\Repository\l\\UserService" alt="" coords="11,6,192,53"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Collaboration diagram for eZ\Publish\Core\Repository\UserService:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService__coll__graph.png" border="0" usemap="#eZ_0CPublish_0CCore_0CRepository_0CUserService_coll__map" alt="Collaboration graph"/></div>
<map name="eZ_0CPublish_0CCore_0CRepository_0CUserService_coll__map" id="eZ_0CPublish_0CCore_0CRepository_0CUserService_coll__map">
<area shape="rect" id="node2" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html" title="eZ\\Publish\\API\\Repository\l\\UserService" alt="" coords="11,6,192,53"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a76df7b94d6d8a83ff1e2edf831d759a6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a76df7b94d6d8a83ff1e2edf831d759a6">__construct</a> (RepositoryInterface $repository, <a class="el" href="interfaceeZ_1_1Publish_1_1SPI_1_1IO_1_1Handler.html">Handler</a> $userHandler, array $settings=array())</td></tr>
<tr class="memitem:a09da5eb27d9ade2238b8df42491853cb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a09da5eb27d9ade2238b8df42491853cb">createUserGroup</a> (APIUserGroupCreateStruct $userGroupCreateStruct, APIUserGroup $parentGroup)</td></tr>
<tr class="memitem:a640f9b85e0b2128e24ad696242b7b913"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a640f9b85e0b2128e24ad696242b7b913">loadUserGroup</a> ($id)</td></tr>
<tr class="memitem:aa2a87a46f1e4bff2cb48c578cf1bdc3a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#aa2a87a46f1e4bff2cb48c578cf1bdc3a">loadSubUserGroups</a> (APIUserGroup $userGroup)</td></tr>
<tr class="memitem:a28e2e4dbf3d76102efac0a2209abf3eb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a28e2e4dbf3d76102efac0a2209abf3eb">deleteUserGroup</a> (APIUserGroup $userGroup)</td></tr>
<tr class="memitem:addc144cf645cef52c02e6044f9db4c03"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#addc144cf645cef52c02e6044f9db4c03">moveUserGroup</a> (APIUserGroup $userGroup, APIUserGroup $newParent)</td></tr>
<tr class="memitem:a21c5eb1213cc039f4658bc0fc6fc9b1e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a21c5eb1213cc039f4658bc0fc6fc9b1e">updateUserGroup</a> (APIUserGroup $userGroup, <a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1User_1_1UserGroupUpdateStruct.html">UserGroupUpdateStruct</a> $userGroupUpdateStruct)</td></tr>
<tr class="memitem:a98dc72cbdccfd6064ff30fbc919421ac"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a98dc72cbdccfd6064ff30fbc919421ac">createUser</a> (APIUserCreateStruct $userCreateStruct, array $parentGroups)</td></tr>
<tr class="memitem:a9ed2d9de7ef5353863fd334705cb7eb5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a9ed2d9de7ef5353863fd334705cb7eb5">loadAnonymousUser</a> ()</td></tr>
<tr class="memitem:ab502862958e517ff3b17ac1a9c0d2cdf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#ab502862958e517ff3b17ac1a9c0d2cdf">loadUserByCredentials</a> ($login, $password)</td></tr>
<tr class="memitem:aa02cf6c117a6f39d9816368cd275a0cf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#aa02cf6c117a6f39d9816368cd275a0cf">deleteUser</a> (APIUser $user)</td></tr>
<tr class="memitem:adee23ecc6d6f3eec627b8967f55318a3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#adee23ecc6d6f3eec627b8967f55318a3">updateUser</a> (APIUser $user, <a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1User_1_1UserUpdateStruct.html">UserUpdateStruct</a> $userUpdateStruct)</td></tr>
<tr class="memitem:a75cfccd623857d4d756212d739cdb4c3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a75cfccd623857d4d756212d739cdb4c3">assignUserToUserGroup</a> (APIUser $user, APIUserGroup $userGroup)</td></tr>
<tr class="memitem:aa231a9aa436dd5d83748c3462aba558b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#aa231a9aa436dd5d83748c3462aba558b">unAssignUserFromUserGroup</a> (APIUser $user, APIUserGroup $userGroup)</td></tr>
<tr class="memitem:aeeeeab77ab6e3b0dafdd8958ac54a5a2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#aeeeeab77ab6e3b0dafdd8958ac54a5a2">loadUserGroupsOfUser</a> (APIUser $user)</td></tr>
<tr class="memitem:ab5159472def04b88ae10b644a4aa819a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#ab5159472def04b88ae10b644a4aa819a">loadUsersOfUserGroup</a> (APIUserGroup $userGroup, $offset=0, $limit=-1)</td></tr>
<tr class="memitem:a1a13a3dd3743d8277b50076eef6c5f3e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a1a13a3dd3743d8277b50076eef6c5f3e">newUserCreateStruct</a> ($login, $email, $password, $mainLanguageCode, $contentType=null)</td></tr>
<tr class="memitem:a1567c0abf56cf3cfb7ceee93006d801d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a1567c0abf56cf3cfb7ceee93006d801d">newUserGroupCreateStruct</a> ($mainLanguageCode, $contentType=null)</td></tr>
<tr class="memitem:a16bbf0876764d14cf59cbe82ece2bcb4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a16bbf0876764d14cf59cbe82ece2bcb4">newUserUpdateStruct</a> ()</td></tr>
<tr class="memitem:aba42580de9875f30ec2765db35f82e00"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#aba42580de9875f30ec2765db35f82e00">newUserGroupUpdateStruct</a> ()</td></tr>
<tr class="inherit_header pub_methods_interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService')"><img src="closed.png" alt="-"/>&nbsp;Public Member Functions inherited from <a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html">eZ\Publish\API\Repository\UserService</a></td></tr>
<tr class="memitem:ac2ab32a29f5db071aaaec3a1c29ee6d8 inherit pub_methods_interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#ac2ab32a29f5db071aaaec3a1c29ee6d8">createUserGroup</a> (<a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1User_1_1UserGroupCreateStruct.html">UserGroupCreateStruct</a> $userGroupCreateStruct, <a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1User_1_1UserGroup.html">UserGroup</a> $parentGroup)</td></tr>
<tr class="memitem:a2615d66e132f0d77eaffc4a0f92d35fd inherit pub_methods_interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a2615d66e132f0d77eaffc4a0f92d35fd">loadSubUserGroups</a> (<a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1User_1_1UserGroup.html">UserGroup</a> $userGroup)</td></tr>
<tr class="memitem:a149c9b772f2a548e45d983794a597f11 inherit pub_methods_interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a149c9b772f2a548e45d983794a597f11">deleteUserGroup</a> (<a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1User_1_1UserGroup.html">UserGroup</a> $userGroup)</td></tr>
<tr class="memitem:a4257e4327120f0d16499c965f590fc9b inherit pub_methods_interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a4257e4327120f0d16499c965f590fc9b">moveUserGroup</a> (<a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1User_1_1UserGroup.html">UserGroup</a> $userGroup, <a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1User_1_1UserGroup.html">UserGroup</a> $newParent)</td></tr>
<tr class="memitem:ad501b31454965dd1705f48e28290d4c1 inherit pub_methods_interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#ad501b31454965dd1705f48e28290d4c1">updateUserGroup</a> (<a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1User_1_1UserGroup.html">UserGroup</a> $userGroup, <a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1User_1_1UserGroupUpdateStruct.html">UserGroupUpdateStruct</a> $userGroupUpdateStruct)</td></tr>
<tr class="memitem:a98cd9e8a0c84a97425126a436ace96cf inherit pub_methods_interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a98cd9e8a0c84a97425126a436ace96cf">createUser</a> (<a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1User_1_1UserCreateStruct.html">UserCreateStruct</a> $userCreateStruct, array $parentGroups)</td></tr>
<tr class="memitem:a3d03923a8446b760aff8ddb4fb94c02d inherit pub_methods_interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a3d03923a8446b760aff8ddb4fb94c02d">loadUser</a> ($userId)</td></tr>
<tr class="memitem:a255001df5a589e2e56b96c6945a8a7ef inherit pub_methods_interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a255001df5a589e2e56b96c6945a8a7ef">deleteUser</a> (<a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1User_1_1User.html">User</a> $user)</td></tr>
<tr class="memitem:ab900cbceaa3bcb91117db603140a4cad inherit pub_methods_interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#ab900cbceaa3bcb91117db603140a4cad">updateUser</a> (<a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1User_1_1User.html">User</a> $user, <a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1User_1_1UserUpdateStruct.html">UserUpdateStruct</a> $userUpdateStruct)</td></tr>
<tr class="memitem:a4f123347fb5c5f94c9224c8bc5cfb858 inherit pub_methods_interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a4f123347fb5c5f94c9224c8bc5cfb858">assignUserToUserGroup</a> (<a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1User_1_1User.html">User</a> $user, <a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1User_1_1UserGroup.html">UserGroup</a> $userGroup)</td></tr>
<tr class="memitem:a532ed88913d8a663ef9f96cdf76bb467 inherit pub_methods_interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a532ed88913d8a663ef9f96cdf76bb467">unAssignUserFromUserGroup</a> (<a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1User_1_1User.html">User</a> $user, <a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1User_1_1UserGroup.html">UserGroup</a> $userGroup)</td></tr>
<tr class="memitem:ac3e84cd7cbf892ed43672a26df115879 inherit pub_methods_interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#ac3e84cd7cbf892ed43672a26df115879">loadUserGroupsOfUser</a> (<a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1User_1_1User.html">User</a> $user)</td></tr>
<tr class="memitem:a4cbdcf6609fdf2519cd8bee635b10b16 inherit pub_methods_interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a4cbdcf6609fdf2519cd8bee635b10b16">loadUsersOfUserGroup</a> (<a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1User_1_1UserGroup.html">UserGroup</a> $userGroup, $offset=0, $limit=-1)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a2b8e691c232b069e519f3585aa718ae1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a2b8e691c232b069e519f3585aa718ae1">searchSubGroups</a> ($locationId, $sortField=null, $sortOrder=<a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1Content_1_1Location.html#a9f40b7c4819bf471456c80c2a4958fb4">Location::SORT_ORDER_ASC</a>, $offset=0, $limit=-1)</td></tr>
<tr class="memitem:a076eaad098ee5bb939f0d71febc41daf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a076eaad098ee5bb939f0d71febc41daf">buildDomainUserGroupObject</a> (APIContent $content)</td></tr>
<tr class="memitem:ac9e0e2bf0968246dbc9d4a27d8793ea8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#ac9e0e2bf0968246dbc9d4a27d8793ea8">buildDomainUserObject</a> (SPIUser $spiUser, APIContent $content=null)</td></tr>
<tr class="memitem:a6b54fb1ebb2122200a1c8bbe5e33fd28"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a6b54fb1ebb2122200a1c8bbe5e33fd28">createPasswordHash</a> ($login, $password, $site, $type)</td></tr>
<tr class="memitem:a941a732658a901463ed9fc76889a5a94"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a941a732658a901463ed9fc76889a5a94">getSortClauseBySortField</a> ($sortField, $sortOrder=<a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1Content_1_1Location.html#a9f40b7c4819bf471456c80c2a4958fb4">Location::SORT_ORDER_ASC</a>)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:adc99fa4080a886ba5681ed62bb7f2574"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#adc99fa4080a886ba5681ed62bb7f2574">$repository</a></td></tr>
<tr class="memitem:a529de19efac12c3532aeb96f27e757af"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a529de19efac12c3532aeb96f27e757af">$userHandler</a></td></tr>
<tr class="memitem:a1214c914e64f779d7fc75258f4476890"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a1214c914e64f779d7fc75258f4476890">$settings</a></td></tr>
</table>
<a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00051">51</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>
</div><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a76df7b94d6d8a83ff1e2edf831d759a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::__construct </td>
          <td>(</td>
          <td class="paramtype">RepositoryInterface&#160;</td>
          <td class="paramname"><em>$repository</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interfaceeZ_1_1Publish_1_1SPI_1_1IO_1_1Handler.html">Handler</a>&#160;</td>
          <td class="paramname"><em>$userHandler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array&#160;</td>
          <td class="paramname"><em>$settings</em> = <code>array()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Setups service with reference to repository object that created it &amp; corresponding handler</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">\eZ\Publish\API\Repository\Repository</td><td class="paramname">$repository</td><td></td></tr>
    <tr><td class="paramtype">\eZ\Publish\SPI\Persistence\User\Handler</td><td class="paramname">$userHandler</td><td></td></tr>
    <tr><td class="paramtype">array</td><td class="paramname">$settings</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00075">75</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>

<p>References <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00056">eZ\Publish\Core\Repository\UserService\$repository</a>, <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00066">eZ\Publish\Core\Repository\UserService\$settings</a>, and <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00061">eZ\Publish\Core\Repository\UserService\$userHandler</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        $this-&gt;repository = <a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#adc99fa4080a886ba5681ed62bb7f2574">$repository</a>;</div>
<div class="line">        $this-&gt;userHandler = <a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a529de19efac12c3532aeb96f27e757af">$userHandler</a>;</div>
<div class="line">        <span class="comment">// Union makes sure default settings are ignored if provided in argument</span></div>
<div class="line">        $this-&gt;settings = <a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a1214c914e64f779d7fc75258f4476890">$settings</a> + array(</div>
<div class="line">            <span class="stringliteral">&#39;anonymousUserID&#39;</span> =&gt; 10,</div>
<div class="line">            <span class="stringliteral">&#39;defaultUserPlacement&#39;</span> =&gt; 12,</div>
<div class="line">            <span class="stringliteral">&#39;userClassID&#39;</span> =&gt; 4,<span class="comment">// @todo Rename this settings to swap out &quot;Class&quot; for &quot;Type&quot;</span></div>
<div class="line">            <span class="stringliteral">&#39;userGroupClassID&#39;</span> =&gt; 3,</div>
<div class="line">            <span class="stringliteral">&#39;hashType&#39;</span> =&gt; User::PASSWORD_HASH_MD5_USER,</div>
<div class="line">            <span class="stringliteral">&#39;siteName&#39;</span> =&gt; <span class="stringliteral">&#39;ez.no&#39;</span></div>
<div class="line">        );</div>
<div class="line">    }</div>
</div><!-- fragment -->
</div>
</div>
<h2>Member Function Documentation</h2>
<a class="anchor" id="a75cfccd623857d4d756212d739cdb4c3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::assignUserToUserGroup </td>
          <td>(</td>
          <td class="paramtype">APIUser&#160;</td>
          <td class="paramname"><em>$user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">APIUserGroup&#160;</td>
          <td class="paramname"><em>$userGroup</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Assigns a new user group to the user</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">\eZ\Publish\API\Repository\Values\User\User</td><td class="paramname">$user</td><td></td></tr>
    <tr><td class="paramtype">\eZ\Publish\API\Repository\Values\User\UserGroup</td><td class="paramname">$userGroup</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\UnauthorizedException</td><td>if the authenticated user is not allowed to assign the user group to the user </td></tr>
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\InvalidArgumentException</td><td>if the user is already in the given user group </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00800">800</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>

<p>References <a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a3d03923a8446b760aff8ddb4fb94c02d">eZ\Publish\API\Repository\UserService\loadUser()</a>, and <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00157">eZ\Publish\Core\Repository\UserService\loadUserGroup()</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> ( !is_numeric( $user-&gt;id ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;id&quot;</span>, $user-&gt;id, <span class="stringliteral">&quot;User&quot;</span> );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( !is_numeric( $userGroup-&gt;id ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;id&quot;</span>, $userGroup-&gt;id, <span class="stringliteral">&quot;UserGroup&quot;</span> );</div>
<div class="line"></div>
<div class="line">        $loadedUser = $this-&gt;<a class="code" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a3d03923a8446b760aff8ddb4fb94c02d">loadUser</a>( $user-&gt;id );</div>
<div class="line">        $loadedGroup = $this-&gt;<a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a640f9b85e0b2128e24ad696242b7b913">loadUserGroup</a>( $userGroup-&gt;id );</div>
<div class="line">        $locationService = $this-&gt;repository-&gt;getLocationService();</div>
<div class="line"></div>
<div class="line">        $existingGroupIds = array();</div>
<div class="line">        $userLocations = $locationService-&gt;loadLocations( $loadedUser-&gt;getVersionInfo()-&gt;getContentInfo() );</div>
<div class="line">        <span class="keywordflow">foreach</span> ( $userLocations as $userLocation )</div>
<div class="line">        {</div>
<div class="line">            $existingGroupIds[] = $userLocation-&gt;parentLocationId;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( $loadedGroup-&gt;getVersionInfo()-&gt;getContentInfo()-&gt;mainLocationId === null )</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> BadStateException( <span class="stringliteral">&quot;userGroup&quot;</span>, <span class="stringliteral">&quot;user group has no main location or no locations&quot;</span> );</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( in_array( $loadedGroup-&gt;getVersionInfo()-&gt;getContentInfo()-&gt;mainLocationId, $existingGroupIds ) )</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// user is already assigned to the user group</span></div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException( <span class="stringliteral">&quot;user&quot;</span>, <span class="stringliteral">&quot;user is already in the given user group&quot;</span> );</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $locationCreateStruct = $locationService-&gt;newLocationCreateStruct(</div>
<div class="line">            $loadedGroup-&gt;getVersionInfo()-&gt;getContentInfo()-&gt;mainLocationId</div>
<div class="line">        );</div>
<div class="line"></div>
<div class="line">        $this-&gt;repository-&gt;beginTransaction();</div>
<div class="line">        <span class="keywordflow">try</span></div>
<div class="line">        {</div>
<div class="line">            $locationService-&gt;createLocation(</div>
<div class="line">                $loadedUser-&gt;getVersionInfo()-&gt;getContentInfo(),</div>
<div class="line">                $locationCreateStruct</div>
<div class="line">            );</div>
<div class="line">            $this-&gt;repository-&gt;commit();</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span> ( \Exception $e )</div>
<div class="line">        {</div>
<div class="line">            $this-&gt;repository-&gt;rollback();</div>
<div class="line">            <span class="keywordflow">throw</span> $e;</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment -->
<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a75cfccd623857d4d756212d739cdb4c3_cgraph.png" border="0" usemap="#classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a75cfccd623857d4d756212d739cdb4c3_cgraph" alt=""/></div>
<map name="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a75cfccd623857d4d756212d739cdb4c3_cgraph" id="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a75cfccd623857d4d756212d739cdb4c3_cgraph">
<area shape="rect" id="node3" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a3d03923a8446b760aff8ddb4fb94c02d" title="eZ\\Publish\\API\\Repository\l\\UserService\\loadUser" alt="" coords="325,5,507,51"/><area shape="rect" id="node5" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a640f9b85e0b2128e24ad696242b7b913" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadUserGroup" alt="" coords="315,74,517,121"/><area shape="rect" id="node7" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a076eaad098ee5bb939f0d71febc41daf" title="eZ\\Publish\\Core\\Repository\l\\UserService\\buildDomainUserGroup\lObject" alt="" coords="565,65,821,129"/><area shape="rect" id="node9" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a2b8e691c232b069e519f3585aa718ae1" title="eZ\\Publish\\Core\\Repository\l\\UserService\\searchSubGroups" alt="" coords="869,74,1091,121"/><area shape="rect" id="node11" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a941a732658a901463ed9fc76889a5a94" title="eZ\\Publish\\Core\\Repository\l\\UserService\\getSortClauseBySortField" alt="" coords="1139,74,1408,121"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a076eaad098ee5bb939f0d71febc41daf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::buildDomainUserGroupObject </td>
          <td>(</td>
          <td class="paramtype">APIContent&#160;</td>
          <td class="paramname"><em>$content</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Builds the domain UserGroup object from provided Content object</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">\eZ\Publish\API\Repository\Values\Content\Content</td><td class="paramname">$content</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l01089">1089</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>

<p>References <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00222">eZ\Publish\Core\Repository\UserService\searchSubGroups()</a>, and <a class="el" href="API_2Repository_2Values_2Content_2Location_8php_source.html#l00048">eZ\Publish\API\Repository\Values\Content\Location\SORT_ORDER_ASC</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        $locationService = $this-&gt;repository-&gt;getLocationService();</div>
<div class="line"></div>
<div class="line">        $subGroupCount = 0;</div>
<div class="line">        <span class="keywordflow">if</span> ( $content-&gt;getVersionInfo()-&gt;getContentInfo()-&gt;mainLocationId !== null )</div>
<div class="line">        {</div>
<div class="line">            $mainLocation = $locationService-&gt;loadLocation(</div>
<div class="line">                $content-&gt;getVersionInfo()-&gt;getContentInfo()-&gt;mainLocationId</div>
<div class="line">            );</div>
<div class="line">            $parentLocation = $locationService-&gt;loadLocation( $mainLocation-&gt;parentLocationId );</div>
<div class="line">            $subGroups = $this-&gt;<a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a2b8e691c232b069e519f3585aa718ae1">searchSubGroups</a>( $mainLocation-&gt;id, null, <a class="code" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1Content_1_1Location.html#a9f40b7c4819bf471456c80c2a4958fb4">Location::SORT_ORDER_ASC</a>, 0, 0 );</div>
<div class="line">            $subGroupCount = $subGroups-&gt;totalCount;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">new</span> UserGroup(</div>
<div class="line">            array(</div>
<div class="line">                <span class="stringliteral">&#39;content&#39;</span> =&gt; $content,</div>
<div class="line">                <span class="stringliteral">&#39;parentId&#39;</span> =&gt; isset( $parentLocation ) ? $parentLocation-&gt;contentId : null,</div>
<div class="line">                <span class="stringliteral">&#39;subGroupCount&#39;</span> =&gt; $subGroupCount</div>
<div class="line">            )</div>
<div class="line">        );</div>
<div class="line">    }</div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a076eaad098ee5bb939f0d71febc41daf_cgraph.png" border="0" usemap="#classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a076eaad098ee5bb939f0d71febc41daf_cgraph" alt=""/></div>
<map name="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a076eaad098ee5bb939f0d71febc41daf_cgraph" id="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a076eaad098ee5bb939f0d71febc41daf_cgraph">
<area shape="rect" id="node3" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a2b8e691c232b069e519f3585aa718ae1" title="eZ\\Publish\\Core\\Repository\l\\UserService\\searchSubGroups" alt="" coords="309,14,531,61"/><area shape="rect" id="node5" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a941a732658a901463ed9fc76889a5a94" title="eZ\\Publish\\Core\\Repository\l\\UserService\\getSortClauseBySortField" alt="" coords="579,14,848,61"/></map>
</div>
</p>

<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a076eaad098ee5bb939f0d71febc41daf_icgraph.png" border="0" usemap="#classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a076eaad098ee5bb939f0d71febc41daf_icgraph" alt=""/></div>
<map name="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a076eaad098ee5bb939f0d71febc41daf_icgraph" id="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a076eaad098ee5bb939f0d71febc41daf_icgraph">
<area shape="rect" id="node3" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a09da5eb27d9ade2238b8df42491853cb" title="eZ\\Publish\\Core\\Repository\l\\UserService\\createUserGroup" alt="" coords="653,5,869,51"/><area shape="rect" id="node5" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a640f9b85e0b2128e24ad696242b7b913" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadUserGroup" alt="" coords="336,259,539,306"/><area shape="rect" id="node8" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#aa2a87a46f1e4bff2cb48c578cf1bdc3a" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadSubUserGroups" alt="" coords="644,74,879,121"/><area shape="rect" id="node14" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a21c5eb1213cc039f4658bc0fc6fc9b1e" title="eZ\\Publish\\Core\\Repository\l\\UserService\\updateUserGroup" alt="" coords="651,559,872,606"/><area shape="rect" id="node26" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#aeeeeab77ab6e3b0dafdd8958ac54a5a2" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadUserGroupsOfUser" alt="" coords="311,379,564,426"/><area shape="rect" id="node10" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a28e2e4dbf3d76102efac0a2209abf3eb" title="eZ\\Publish\\Core\\Repository\l\\UserService\\deleteUserGroup" alt="" coords="653,351,869,398"/><area shape="rect" id="node12" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#addc144cf645cef52c02e6044f9db4c03" title="eZ\\Publish\\Core\\Repository\l\\UserService\\moveUserGroup" alt="" coords="656,421,867,467"/><area shape="rect" id="node16" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a98dc72cbdccfd6064ff30fbc919421ac" title="eZ\\Publish\\Core\\Repository\l\\UserService\\createUser" alt="" coords="665,490,857,537"/><area shape="rect" id="node18" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a75cfccd623857d4d756212d739cdb4c3" title="eZ\\Publish\\Core\\Repository\l\\UserService\\assignUserToUserGroup" alt="" coords="632,143,891,190"/><area shape="rect" id="node20" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#aa231a9aa436dd5d83748c3462aba558b" title="eZ\\Publish\\Core\\Repository\l\\UserService\\unAssignUserFromUserGroup" alt="" coords="613,213,909,259"/><area shape="rect" id="node22" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#ab5159472def04b88ae10b644a4aa819a" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadUsersOfUserGroup" alt="" coords="635,282,888,329"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac9e0e2bf0968246dbc9d4a27d8793ea8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::buildDomainUserObject </td>
          <td>(</td>
          <td class="paramtype">SPIUser&#160;</td>
          <td class="paramname"><em>$spiUser</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">APIContent&#160;</td>
          <td class="paramname"><em>$content</em> = <code>null</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Builds the domain user object from provided persistence user object</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">\eZ\Publish\SPI\Persistence\User</td><td class="paramname">$spiUser</td><td></td></tr>
    <tr><td class="paramtype">\eZ\Publish\API\Repository\Values\Content\Content&#160;|&#160;null</td><td class="paramname">$content</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l01121">1121</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> ( $content === null )</div>
<div class="line">            $content = $this-&gt;repository-&gt;getContentService()-&gt;internalLoadContent( $spiUser-&gt;id );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">new</span> User(</div>
<div class="line">            array(</div>
<div class="line">                <span class="stringliteral">&#39;content&#39;</span> =&gt; $content,</div>
<div class="line">                <span class="stringliteral">&#39;login&#39;</span> =&gt; $spiUser-&gt;login,</div>
<div class="line">                <span class="stringliteral">&#39;email&#39;</span> =&gt; $spiUser-&gt;email,</div>
<div class="line">                <span class="stringliteral">&#39;passwordHash&#39;</span> =&gt; $spiUser-&gt;passwordHash,</div>
<div class="line">                <span class="stringliteral">&#39;hashAlgorithm&#39;</span> =&gt; (<span class="keywordtype">int</span>)$spiUser-&gt;hashAlgorithm,</div>
<div class="line">                <span class="stringliteral">&#39;enabled&#39;</span> =&gt; $spiUser-&gt;isEnabled,</div>
<div class="line">                <span class="stringliteral">&#39;maxLogin&#39;</span> =&gt; (<span class="keywordtype">int</span>)$spiUser-&gt;maxLogin,</div>
<div class="line">            )</div>
<div class="line">        );</div>
<div class="line">    }</div>
</div><!-- fragment -->
<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_ac9e0e2bf0968246dbc9d4a27d8793ea8_icgraph.png" border="0" usemap="#classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_ac9e0e2bf0968246dbc9d4a27d8793ea8_icgraph" alt=""/></div>
<map name="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_ac9e0e2bf0968246dbc9d4a27d8793ea8_icgraph" id="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_ac9e0e2bf0968246dbc9d4a27d8793ea8_icgraph">
<area shape="rect" id="node3" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a98dc72cbdccfd6064ff30fbc919421ac" title="eZ\\Publish\\Core\\Repository\l\\UserService\\createUser" alt="" coords="344,5,536,51"/><area shape="rect" id="node5" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#ab502862958e517ff3b17ac1a9c0d2cdf" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadUserByCredentials" alt="" coords="315,74,565,121"/><area shape="rect" id="node7" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#ab5159472def04b88ae10b644a4aa819a" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadUsersOfUserGroup" alt="" coords="313,143,567,190"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6b54fb1ebb2122200a1c8bbe5e33fd28"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::createPasswordHash </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$login</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$site</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns password hash based on user data and site settings</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$login</td><td>User login </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$password</td><td>User password </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$site</td><td>The name of the site </td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$type</td><td>Type of password to generate</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string Generated password hash </dd></dl>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l01149">1149</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        <span class="keywordflow">switch</span> ( $type )</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">case</span> User::PASSWORD_HASH_MD5_PASSWORD:</div>
<div class="line">                <span class="keywordflow">return</span> md5( $password );</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">case</span> User::PASSWORD_HASH_MD5_USER:</div>
<div class="line">                <span class="keywordflow">return</span> md5( <span class="stringliteral">&quot;$login\n$password&quot;</span> );</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">case</span> User::PASSWORD_HASH_MD5_SITE:</div>
<div class="line">                <span class="keywordflow">return</span> md5( <span class="stringliteral">&quot;$login\n$password\n$site&quot;</span> );</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">case</span> User::PASSWORD_HASH_PLAINTEXT:</div>
<div class="line">                <span class="keywordflow">return</span> $password;</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">default</span>:</div>
<div class="line">                <span class="keywordflow">return</span> md5( $password );</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment -->
<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a6b54fb1ebb2122200a1c8bbe5e33fd28_icgraph.png" border="0" usemap="#classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a6b54fb1ebb2122200a1c8bbe5e33fd28_icgraph" alt=""/></div>
<map name="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a6b54fb1ebb2122200a1c8bbe5e33fd28_icgraph" id="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a6b54fb1ebb2122200a1c8bbe5e33fd28_icgraph">
<area shape="rect" id="node3" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#ab502862958e517ff3b17ac1a9c0d2cdf" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadUserByCredentials" alt="" coords="295,5,545,51"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a98dc72cbdccfd6064ff30fbc919421ac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::createUser </td>
          <td>(</td>
          <td class="paramtype">APIUserCreateStruct&#160;</td>
          <td class="paramname"><em>$userCreateStruct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array&#160;</td>
          <td class="paramname"><em>$parentGroups</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new user. The created user is published by this method</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">\eZ\Publish\API\Repository\Values\User\UserCreateStruct</td><td class="paramname">$userCreateStruct</td><td>the data used for creating the user </td></tr>
    <tr><td class="paramtype"></td><td class="paramname">\eZ\Publish\API\Repository\Values\User\UserGroup[]</td><td>$parentGroups the groups which are assigned to the user after creation</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\UnauthorizedException</td><td>if the authenticated user is not allowed to move the user group </td></tr>
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\ContentFieldValidationException</td><td>if a field in the $userCreateStruct is not valid </td></tr>
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\ContentValidationException</td><td>if a required field is missing or set to an empty value </td></tr>
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\InvalidArgumentException</td><td>if a user with provided login already exists </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00402">402</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>

<p>References <a class="el" href="Core_2Repository_2UserService_8php_source.html#l01121">eZ\Publish\Core\Repository\UserService\buildDomainUserObject()</a>, and <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00157">eZ\Publish\Core\Repository\UserService\loadUserGroup()</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> ( empty( $parentGroups ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;parentGroups&quot;</span>, $parentGroups );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( !is_string( $userCreateStruct-&gt;login ) || empty( $userCreateStruct-&gt;login ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;login&quot;</span>, $userCreateStruct-&gt;login, <span class="stringliteral">&quot;UserCreateStruct&quot;</span> );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( !is_string( $userCreateStruct-&gt;email ) || empty( $userCreateStruct-&gt;email ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;email&quot;</span>, $userCreateStruct-&gt;email, <span class="stringliteral">&quot;UserCreateStruct&quot;</span> );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( !ezcMailTools::validateEmailAddress( $userCreateStruct-&gt;email ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;email&quot;</span>, $userCreateStruct-&gt;email, <span class="stringliteral">&quot;UserCreateStruct&quot;</span> );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( !is_string( $userCreateStruct-&gt;password ) || empty( $userCreateStruct-&gt;password ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;password&quot;</span>, $userCreateStruct-&gt;password, <span class="stringliteral">&quot;UserCreateStruct&quot;</span> );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( !is_bool( $userCreateStruct-&gt;enabled ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;enabled&quot;</span>, $userCreateStruct-&gt;enabled, <span class="stringliteral">&quot;UserCreateStruct&quot;</span> );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">try</span></div>
<div class="line">        {</div>
<div class="line">            $this-&gt;userHandler-&gt;loadByLogin( $userCreateStruct-&gt;login );</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException( <span class="stringliteral">&quot;userCreateStruct&quot;</span>, <span class="stringliteral">&quot;User with provided login already exists&quot;</span> );</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span> ( NotFoundException $e )</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// Do nothing</span></div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $contentService = $this-&gt;repository-&gt;getContentService();</div>
<div class="line">        $locationService = $this-&gt;repository-&gt;getLocationService();</div>
<div class="line">        $contentTypeService = $this-&gt;repository-&gt;getContentTypeService();</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( $userCreateStruct-&gt;contentType === null )</div>
<div class="line">        {</div>
<div class="line">            $userContentType = $contentTypeService-&gt;loadContentType( $this-&gt;settings[<span class="stringliteral">&#39;userClassID&#39;</span>] );</div>
<div class="line">            $userCreateStruct-&gt;contentType = $userContentType;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $locationCreateStructs = array();</div>
<div class="line">        <span class="keywordflow">foreach</span> ( $parentGroups as $parentGroup )</div>
<div class="line">        {</div>
<div class="line">            $parentGroup = $this-&gt;<a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a640f9b85e0b2128e24ad696242b7b913">loadUserGroup</a>( $parentGroup-&gt;id );</div>
<div class="line">            <span class="keywordflow">if</span> ( $parentGroup-&gt;getVersionInfo()-&gt;getContentInfo()-&gt;mainLocationId !== null )</div>
<div class="line">            {</div>
<div class="line">                $locationCreateStructs[] = $locationService-&gt;newLocationCreateStruct(</div>
<div class="line">                    $parentGroup-&gt;getVersionInfo()-&gt;getContentInfo()-&gt;mainLocationId</div>
<div class="line">                );</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Search for the first ezuser field type in content type</span></div>
<div class="line">        $userFieldDefinition = null;</div>
<div class="line">        <span class="keywordflow">foreach</span> ( $userCreateStruct-&gt;contentType-&gt;getFieldDefinitions() as $fieldDefinition )</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> ( $fieldDefinition-&gt;fieldTypeIdentifier == <span class="stringliteral">&#39;ezuser&#39;</span> )</div>
<div class="line">            {</div>
<div class="line">                $userFieldDefinition = $fieldDefinition;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( $userFieldDefinition === null )</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> ContentValidationException( <span class="stringliteral">&quot;Provided content type does not contain ezuser field type&quot;</span> );</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $fixUserFieldType = <span class="keyword">true</span>;</div>
<div class="line">        <span class="keywordflow">foreach</span> ( $userCreateStruct-&gt;fields as $index =&gt; $field )</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> ( $field-&gt;fieldDefIdentifier == $userFieldDefinition-&gt;identifier )</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">if</span> ( $field-&gt;value instanceof UserValue )</div>
<div class="line">                {</div>
<div class="line">                    $userCreateStruct-&gt;fields[$index]-&gt;value-&gt;login = $userCreateStruct-&gt;login;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                {</div>
<div class="line">                    $userCreateStruct-&gt;fields[$index]-&gt;value = <span class="keyword">new</span> UserValue(</div>
<div class="line">                        array(</div>
<div class="line">                            <span class="stringliteral">&#39;login&#39;</span> =&gt; $userCreateStruct-&gt;login</div>
<div class="line">                        )</div>
<div class="line">                    );</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                $fixUserFieldType = <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( $fixUserFieldType )</div>
<div class="line">        {</div>
<div class="line">            $userCreateStruct-&gt;setField(</div>
<div class="line">                $userFieldDefinition-&gt;identifier,</div>
<div class="line">                <span class="keyword">new</span> UserValue(</div>
<div class="line">                    array(</div>
<div class="line">                        <span class="stringliteral">&#39;login&#39;</span> =&gt; $userCreateStruct-&gt;login</div>
<div class="line">                    )</div>
<div class="line">                )</div>
<div class="line">            );</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $this-&gt;repository-&gt;beginTransaction();</div>
<div class="line">        <span class="keywordflow">try</span></div>
<div class="line">        {</div>
<div class="line">            $contentDraft = $contentService-&gt;createContent( $userCreateStruct, $locationCreateStructs );</div>
<div class="line">            $publishedContent = $contentService-&gt;publishVersion( $contentDraft-&gt;getVersionInfo() );</div>
<div class="line"></div>
<div class="line">            $spiUser = $this-&gt;userHandler-&gt;create(</div>
<div class="line">                <span class="keyword">new</span> SPIUser(</div>
<div class="line">                    array(</div>
<div class="line">                        <span class="stringliteral">&#39;id&#39;</span> =&gt; $publishedContent-&gt;id,</div>
<div class="line">                        <span class="stringliteral">&#39;login&#39;</span> =&gt; $userCreateStruct-&gt;login,</div>
<div class="line">                        <span class="stringliteral">&#39;email&#39;</span> =&gt; $userCreateStruct-&gt;email,</div>
<div class="line">                        <span class="stringliteral">&#39;passwordHash&#39;</span> =&gt; $this-&gt;createPasswordHash(</div>
<div class="line">                            $userCreateStruct-&gt;login,</div>
<div class="line">                            $userCreateStruct-&gt;password,</div>
<div class="line">                            $this-&gt;settings[<span class="stringliteral">&#39;siteName&#39;</span>],</div>
<div class="line">                            $this-&gt;settings[<span class="stringliteral">&#39;hashType&#39;</span>]</div>
<div class="line">                        ),</div>
<div class="line">                        <span class="stringliteral">&#39;hashAlgorithm&#39;</span> =&gt; $this-&gt;settings[<span class="stringliteral">&#39;hashType&#39;</span>],</div>
<div class="line">                        <span class="stringliteral">&#39;isEnabled&#39;</span> =&gt; $userCreateStruct-&gt;enabled,</div>
<div class="line">                        <span class="stringliteral">&#39;maxLogin&#39;</span> =&gt; 0</div>
<div class="line">                    )</div>
<div class="line">                )</div>
<div class="line">            );</div>
<div class="line"></div>
<div class="line">            $this-&gt;repository-&gt;commit();</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span> ( \Exception $e )</div>
<div class="line">        {</div>
<div class="line">            $this-&gt;repository-&gt;rollback();</div>
<div class="line">            <span class="keywordflow">throw</span> $e;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#ac9e0e2bf0968246dbc9d4a27d8793ea8">buildDomainUserObject</a>(</div>
<div class="line">            $spiUser,</div>
<div class="line">            $contentService-&gt;loadContent( $publishedContent-&gt;id )<span class="comment">// Reload to get with updated user field value</span></div>
<div class="line">        );</div>
<div class="line">    }</div>
</div><!-- fragment -->
<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a98dc72cbdccfd6064ff30fbc919421ac_cgraph.png" border="0" usemap="#classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a98dc72cbdccfd6064ff30fbc919421ac_cgraph" alt=""/></div>
<map name="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a98dc72cbdccfd6064ff30fbc919421ac_cgraph" id="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a98dc72cbdccfd6064ff30fbc919421ac_cgraph">
<area shape="rect" id="node3" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#ac9e0e2bf0968246dbc9d4a27d8793ea8" title="eZ\\Publish\\Core\\Repository\l\\UserService\\buildDomainUserObject" alt="" coords="248,5,507,51"/><area shape="rect" id="node5" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a640f9b85e0b2128e24ad696242b7b913" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadUserGroup" alt="" coords="276,74,479,121"/><area shape="rect" id="node7" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a076eaad098ee5bb939f0d71febc41daf" title="eZ\\Publish\\Core\\Repository\l\\UserService\\buildDomainUserGroup\lObject" alt="" coords="555,65,811,129"/><area shape="rect" id="node9" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a2b8e691c232b069e519f3585aa718ae1" title="eZ\\Publish\\Core\\Repository\l\\UserService\\searchSubGroups" alt="" coords="859,74,1080,121"/><area shape="rect" id="node11" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a941a732658a901463ed9fc76889a5a94" title="eZ\\Publish\\Core\\Repository\l\\UserService\\getSortClauseBySortField" alt="" coords="1128,74,1397,121"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a09da5eb27d9ade2238b8df42491853cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::createUserGroup </td>
          <td>(</td>
          <td class="paramtype">APIUserGroupCreateStruct&#160;</td>
          <td class="paramname"><em>$userGroupCreateStruct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">APIUserGroup&#160;</td>
          <td class="paramname"><em>$parentGroup</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a new user group using the data provided in the ContentCreateStruct parameter</p>
<p>In 4.x in the content type parameter in the profile is ignored</p>
<ul>
<li>the content type is determined via configuration and can be set to null. The returned version is published.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">\eZ\Publish\API\Repository\Values\User\UserGroupCreateStruct</td><td class="paramname">$userGroupCreateStruct</td><td>a structure for setting all necessary data to create this user group </td></tr>
    <tr><td class="paramtype">\eZ\Publish\API\Repository\Values\User\UserGroup</td><td class="paramname">$parentGroup</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\UnauthorizedException</td><td>if the authenticated user is not allowed to create a user group </td></tr>
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\InvalidArgumentException</td><td>if the input structure has invalid data </td></tr>
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\ContentFieldValidationException</td><td>if a field in the $userGroupCreateStruct is not valid </td></tr>
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\ContentValidationException</td><td>if a required field is missing or set to an empty value </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00107">107</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>

<p>References <a class="el" href="Core_2Repository_2UserService_8php_source.html#l01089">eZ\Publish\Core\Repository\UserService\buildDomainUserGroupObject()</a>, and <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00157">eZ\Publish\Core\Repository\UserService\loadUserGroup()</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> ( !is_numeric( $parentGroup-&gt;id ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;id&quot;</span>, $parentGroup-&gt;id, <span class="stringliteral">&quot;UserGroup&quot;</span> );</div>
<div class="line"></div>
<div class="line">        $contentService = $this-&gt;repository-&gt;getContentService();</div>
<div class="line">        $locationService = $this-&gt;repository-&gt;getLocationService();</div>
<div class="line">        $contentTypeService = $this-&gt;repository-&gt;getContentTypeService();</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( $userGroupCreateStruct-&gt;contentType === null )</div>
<div class="line">        {</div>
<div class="line">            $userGroupContentType = $contentTypeService-&gt;loadContentType( $this-&gt;settings[<span class="stringliteral">&#39;userGroupClassID&#39;</span>] );</div>
<div class="line">            $userGroupCreateStruct-&gt;contentType = $userGroupContentType;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $loadedParentGroup = $this-&gt;<a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a640f9b85e0b2128e24ad696242b7b913">loadUserGroup</a>( $parentGroup-&gt;id );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( $loadedParentGroup-&gt;getVersionInfo()-&gt;getContentInfo()-&gt;mainLocationId === null )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException( <span class="stringliteral">&quot;parentGroup&quot;</span>, <span class="stringliteral">&quot;parent user group has no main location&quot;</span> );</div>
<div class="line"></div>
<div class="line">        $locationCreateStruct = $locationService-&gt;newLocationCreateStruct(</div>
<div class="line">            $loadedParentGroup-&gt;getVersionInfo()-&gt;getContentInfo()-&gt;mainLocationId</div>
<div class="line">        );</div>
<div class="line"></div>
<div class="line">        $this-&gt;repository-&gt;beginTransaction();</div>
<div class="line">        <span class="keywordflow">try</span></div>
<div class="line">        {</div>
<div class="line">            $contentDraft = $contentService-&gt;createContent( $userGroupCreateStruct, array( $locationCreateStruct ) );</div>
<div class="line">            $publishedContent = $contentService-&gt;publishVersion( $contentDraft-&gt;getVersionInfo() );</div>
<div class="line">            $this-&gt;repository-&gt;commit();</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span> ( \Exception $e )</div>
<div class="line">        {</div>
<div class="line">            $this-&gt;repository-&gt;rollback();</div>
<div class="line">            <span class="keywordflow">throw</span> $e;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a076eaad098ee5bb939f0d71febc41daf">buildDomainUserGroupObject</a>( $publishedContent );</div>
<div class="line">    }</div>
</div><!-- fragment -->
<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a09da5eb27d9ade2238b8df42491853cb_cgraph.png" border="0" usemap="#classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a09da5eb27d9ade2238b8df42491853cb_cgraph" alt=""/></div>
<map name="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a09da5eb27d9ade2238b8df42491853cb_cgraph" id="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a09da5eb27d9ade2238b8df42491853cb_cgraph">
<area shape="rect" id="node3" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a076eaad098ee5bb939f0d71febc41daf" title="eZ\\Publish\\Core\\Repository\l\\UserService\\buildDomainUserGroup\lObject" alt="" coords="523,5,779,69"/><area shape="rect" id="node9" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a640f9b85e0b2128e24ad696242b7b913" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadUserGroup" alt="" coords="272,43,475,90"/><area shape="rect" id="node5" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a2b8e691c232b069e519f3585aa718ae1" title="eZ\\Publish\\Core\\Repository\l\\UserService\\searchSubGroups" alt="" coords="827,14,1048,61"/><area shape="rect" id="node7" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a941a732658a901463ed9fc76889a5a94" title="eZ\\Publish\\Core\\Repository\l\\UserService\\getSortClauseBySortField" alt="" coords="1096,14,1365,61"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa02cf6c117a6f39d9816368cd275a0cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::deleteUser </td>
          <td>(</td>
          <td class="paramtype">APIUser&#160;</td>
          <td class="paramname"><em>$user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This method deletes a user</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">\eZ\Publish\API\Repository\Values\User\User</td><td class="paramname">$user</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\UnauthorizedException</td><td>if the authenticated user is not allowed to delete the user </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00653">653</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>

<p>References <a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a3d03923a8446b760aff8ddb4fb94c02d">eZ\Publish\API\Repository\UserService\loadUser()</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> ( !is_numeric( $user-&gt;id ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;id&quot;</span>, $user-&gt;id, <span class="stringliteral">&quot;User&quot;</span> );</div>
<div class="line"></div>
<div class="line">        $loadedUser = $this-&gt;<a class="code" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a3d03923a8446b760aff8ddb4fb94c02d">loadUser</a>( $user-&gt;id );</div>
<div class="line"></div>
<div class="line">        $this-&gt;repository-&gt;beginTransaction();</div>
<div class="line">        <span class="keywordflow">try</span></div>
<div class="line">        {</div>
<div class="line">            $this-&gt;repository-&gt;getContentService()-&gt;deleteContent( $loadedUser-&gt;getVersionInfo()-&gt;getContentInfo() );</div>
<div class="line">            $this-&gt;repository-&gt;commit();</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span> ( \Exception $e )</div>
<div class="line">        {</div>
<div class="line">            $this-&gt;repository-&gt;rollback();</div>
<div class="line">            <span class="keywordflow">throw</span> $e;</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment -->
<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_aa02cf6c117a6f39d9816368cd275a0cf_cgraph.png" border="0" usemap="#classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_aa02cf6c117a6f39d9816368cd275a0cf_cgraph" alt=""/></div>
<map name="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_aa02cf6c117a6f39d9816368cd275a0cf_cgraph" id="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_aa02cf6c117a6f39d9816368cd275a0cf_cgraph">
<area shape="rect" id="node3" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a3d03923a8446b760aff8ddb4fb94c02d" title="eZ\\Publish\\API\\Repository\l\\UserService\\loadUser" alt="" coords="249,5,431,51"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a28e2e4dbf3d76102efac0a2209abf3eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::deleteUserGroup </td>
          <td>(</td>
          <td class="paramtype">APIUserGroup&#160;</td>
          <td class="paramname"><em>$userGroup</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Removes a user group</p>
<p>the users which are not assigned to other groups will be deleted.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">\eZ\Publish\API\Repository\Values\User\UserGroup</td><td class="paramname">$userGroup</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\UnauthorizedException</td><td>if the authenticated user is not allowed to create a user group </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00255">255</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>

<p>References <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00157">eZ\Publish\Core\Repository\UserService\loadUserGroup()</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> ( !is_numeric( $userGroup-&gt;id ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;id&quot;</span>, $userGroup-&gt;id, <span class="stringliteral">&quot;UserGroup&quot;</span> );</div>
<div class="line"></div>
<div class="line">        $loadedUserGroup = $this-&gt;<a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a640f9b85e0b2128e24ad696242b7b913">loadUserGroup</a>( $userGroup-&gt;id );</div>
<div class="line"></div>
<div class="line">        $this-&gt;repository-&gt;beginTransaction();</div>
<div class="line">        <span class="keywordflow">try</span></div>
<div class="line">        {</div>
<div class="line">            <span class="comment">//@todo: what happens to sub user groups and users below sub user groups</span></div>
<div class="line">            $this-&gt;repository-&gt;getContentService()-&gt;deleteContent( $loadedUserGroup-&gt;getVersionInfo()-&gt;getContentInfo() );</div>
<div class="line">            $this-&gt;repository-&gt;commit();</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span> ( \Exception $e )</div>
<div class="line">        {</div>
<div class="line">            $this-&gt;repository-&gt;rollback();</div>
<div class="line">            <span class="keywordflow">throw</span> $e;</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment -->
<p><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a28e2e4dbf3d76102efac0a2209abf3eb_cgraph.png" border="0" usemap="#classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a28e2e4dbf3d76102efac0a2209abf3eb_cgraph" alt=""/></div>
<map name="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a28e2e4dbf3d76102efac0a2209abf3eb_cgraph" id="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a28e2e4dbf3d76102efac0a2209abf3eb_cgraph">
<area shape="rect" id="node3" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a640f9b85e0b2128e24ad696242b7b913" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadUserGroup" alt="" coords="269,14,472,61"/><area shape="rect" id="node5" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a076eaad098ee5bb939f0d71febc41daf" title="eZ\\Publish\\Core\\Repository\l\\UserService\\buildDomainUserGroup\lObject" alt="" coords="520,5,776,69"/><area shape="rect" id="node7" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a2b8e691c232b069e519f3585aa718ae1" title="eZ\\Publish\\Core\\Repository\l\\UserService\\searchSubGroups" alt="" coords="824,14,1045,61"/><area shape="rect" id="node9" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a941a732658a901463ed9fc76889a5a94" title="eZ\\Publish\\Core\\Repository\l\\UserService\\getSortClauseBySortField" alt="" coords="1093,14,1363,61"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a941a732658a901463ed9fc76889a5a94"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::getSortClauseBySortField </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$sortField</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$sortOrder</em> = <code><a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1Content_1_1Location.html#a9f40b7c4819bf471456c80c2a4958fb4">Location::SORT_ORDER_ASC</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Instantiates a correct sort clause object based on provided location sort field and sort order</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$sortField</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$sortOrder</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l01178">1178</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>

<p>References <a class="el" href="Query_8php_source.html#l00019">eZ\Publish\API\Repository\Values\Content\Query\SORT_ASC</a>, <a class="el" href="Query_8php_source.html#l00021">eZ\Publish\API\Repository\Values\Content\Query\SORT_DESC</a>, <a class="el" href="API_2Repository_2Values_2Content_2Location_8php_source.html#l00038">eZ\Publish\API\Repository\Values\Content\Location\SORT_FIELD_DEPTH</a>, <a class="el" href="API_2Repository_2Values_2Content_2Location_8php_source.html#l00036">eZ\Publish\API\Repository\Values\Content\Location\SORT_FIELD_MODIFIED</a>, <a class="el" href="API_2Repository_2Values_2Content_2Location_8php_source.html#l00042">eZ\Publish\API\Repository\Values\Content\Location\SORT_FIELD_NAME</a>, <a class="el" href="API_2Repository_2Values_2Content_2Location_8php_source.html#l00034">eZ\Publish\API\Repository\Values\Content\Location\SORT_FIELD_PATH</a>, <a class="el" href="API_2Repository_2Values_2Content_2Location_8php_source.html#l00041">eZ\Publish\API\Repository\Values\Content\Location\SORT_FIELD_PRIORITY</a>, <a class="el" href="API_2Repository_2Values_2Content_2Location_8php_source.html#l00035">eZ\Publish\API\Repository\Values\Content\Location\SORT_FIELD_PUBLISHED</a>, <a class="el" href="API_2Repository_2Values_2Content_2Location_8php_source.html#l00037">eZ\Publish\API\Repository\Values\Content\Location\SORT_FIELD_SECTION</a>, and <a class="el" href="API_2Repository_2Values_2Content_2Location_8php_source.html#l00047">eZ\Publish\API\Repository\Values\Content\Location\SORT_ORDER_DESC</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        $sortOrder = $sortOrder == <a class="code" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1Content_1_1Location.html#a6a88cd0aa815e25e81317e92f6b59aa8">Location::SORT_ORDER_DESC</a> ? <a class="code" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1Content_1_1Query.html#a12bfd8048c9939672662cebce05ca02c">Query::SORT_DESC</a> : <a class="code" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1Content_1_1Query.html#a4bcd94044e034245bc817614b3057ede">Query::SORT_ASC</a>;</div>
<div class="line">        <span class="keywordflow">switch</span> ( $sortField )</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">case</span> <a class="code" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1Content_1_1Location.html#a404fc367285558bbb1fc281a7ff9dc0c">Location::SORT_FIELD_PATH</a>:</div>
<div class="line">                <span class="keywordflow">return</span> new \eZ\Publish\API\Repository\Values\Content\Query\SortClause\LocationPathString( $sortOrder );</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">case</span> <a class="code" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1Content_1_1Location.html#ab0fd67f3b78717bea20331d46420720c">Location::SORT_FIELD_PUBLISHED</a>:</div>
<div class="line">                <span class="keywordflow">return</span> new \eZ\Publish\API\Repository\Values\Content\Query\SortClause\DatePublished( $sortOrder );</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">case</span> <a class="code" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1Content_1_1Location.html#a0baffbcb8a206e3ed8fa18bc453a50a7">Location::SORT_FIELD_MODIFIED</a>:</div>
<div class="line">                <span class="keywordflow">return</span> new \eZ\Publish\API\Repository\Values\Content\Query\SortClause\DateModified( $sortOrder );</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">case</span> <a class="code" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1Content_1_1Location.html#a5ec2f22de4f66dd3131cce3b888b22a5">Location::SORT_FIELD_SECTION</a>:</div>
<div class="line">                <span class="keywordflow">return</span> new \eZ\Publish\API\Repository\Values\Content\Query\SortClause\SectionIdentifier( $sortOrder );</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">case</span> <a class="code" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1Content_1_1Location.html#a3c00f67128f3ded090d36104567be5d9">Location::SORT_FIELD_DEPTH</a>:</div>
<div class="line">                <span class="keywordflow">return</span> new \eZ\Publish\API\Repository\Values\Content\Query\SortClause\LocationDepth( $sortOrder );</div>
<div class="line"></div>
<div class="line">            <span class="comment">//@todo: enable</span></div>
<div class="line">            <span class="comment">// case APILocation::SORT_FIELD_CLASS_IDENTIFIER:</span></div>
<div class="line"></div>
<div class="line">            <span class="comment">//@todo: enable</span></div>
<div class="line">            <span class="comment">// case APILocation::SORT_FIELD_CLASS_NAME:</span></div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">case</span> <a class="code" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1Content_1_1Location.html#aa9b17c8c3f49ad56326c08b77a43baad">Location::SORT_FIELD_PRIORITY</a>:</div>
<div class="line">                <span class="keywordflow">return</span> new \eZ\Publish\API\Repository\Values\Content\Query\SortClause\LocationPriority( $sortOrder );</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">case</span> <a class="code" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1Content_1_1Location.html#ac6013b3576be14ffaa45614e9d1c4cd8">Location::SORT_FIELD_NAME</a>:</div>
<div class="line">                <span class="keywordflow">return</span> new \eZ\Publish\API\Repository\Values\Content\Query\SortClause\ContentName( $sortOrder );</div>
<div class="line"></div>
<div class="line">            <span class="comment">//@todo: enable</span></div>
<div class="line">            <span class="comment">// case APILocation::SORT_FIELD_MODIFIED_SUBNODE:</span></div>
<div class="line"></div>
<div class="line">            <span class="comment">//@todo: enable</span></div>
<div class="line">            <span class="comment">// case APILocation::SORT_FIELD_NODE_ID:</span></div>
<div class="line"></div>
<div class="line">            <span class="comment">//@todo: enable</span></div>
<div class="line">            <span class="comment">// case APILocation::SORT_FIELD_CONTENTOBJECT_ID:</span></div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">default</span>:</div>
<div class="line">                <span class="keywordflow">return</span> new \eZ\Publish\API\Repository\Values\Content\Query\SortClause\LocationPathString( $sortOrder );</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment -->
<p><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a941a732658a901463ed9fc76889a5a94_icgraph.png" border="0" usemap="#classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a941a732658a901463ed9fc76889a5a94_icgraph" alt=""/></div>
<map name="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a941a732658a901463ed9fc76889a5a94_icgraph" id="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a941a732658a901463ed9fc76889a5a94_icgraph">
<area shape="rect" id="node3" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a2b8e691c232b069e519f3585aa718ae1" title="eZ\\Publish\\Core\\Repository\l\\UserService\\searchSubGroups" alt="" coords="323,275,544,322"/><area shape="rect" id="node27" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#ab5159472def04b88ae10b644a4aa819a" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadUsersOfUserGroup" alt="" coords="1221,559,1475,606"/><area shape="rect" id="node5" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#aa2a87a46f1e4bff2cb48c578cf1bdc3a" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadSubUserGroups" alt="" coords="1231,5,1465,51"/><area shape="rect" id="node7" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a076eaad098ee5bb939f0d71febc41daf" title="eZ\\Publish\\Core\\Repository\l\\UserService\\buildDomainUserGroup\lObject" alt="" coords="592,267,848,331"/><area shape="rect" id="node9" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a09da5eb27d9ade2238b8df42491853cb" title="eZ\\Publish\\Core\\Repository\l\\UserService\\createUserGroup" alt="" coords="1240,74,1456,121"/><area shape="rect" id="node11" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a640f9b85e0b2128e24ad696242b7b913" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadUserGroup" alt="" coords="923,275,1125,322"/><area shape="rect" id="node19" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a21c5eb1213cc039f4658bc0fc6fc9b1e" title="eZ\\Publish\\Core\\Repository\l\\UserService\\updateUserGroup" alt="" coords="1237,490,1459,537"/><area shape="rect" id="node31" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#aeeeeab77ab6e3b0dafdd8958ac54a5a2" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadUserGroupsOfUser" alt="" coords="897,395,1151,442"/><area shape="rect" id="node15" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a28e2e4dbf3d76102efac0a2209abf3eb" title="eZ\\Publish\\Core\\Repository\l\\UserService\\deleteUserGroup" alt="" coords="1240,143,1456,190"/><area shape="rect" id="node17" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#addc144cf645cef52c02e6044f9db4c03" title="eZ\\Publish\\Core\\Repository\l\\UserService\\moveUserGroup" alt="" coords="1243,213,1453,259"/><area shape="rect" id="node21" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a98dc72cbdccfd6064ff30fbc919421ac" title="eZ\\Publish\\Core\\Repository\l\\UserService\\createUser" alt="" coords="1252,282,1444,329"/><area shape="rect" id="node23" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a75cfccd623857d4d756212d739cdb4c3" title="eZ\\Publish\\Core\\Repository\l\\UserService\\assignUserToUserGroup" alt="" coords="1219,351,1477,398"/><area shape="rect" id="node25" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#aa231a9aa436dd5d83748c3462aba558b" title="eZ\\Publish\\Core\\Repository\l\\UserService\\unAssignUserFromUserGroup" alt="" coords="1200,421,1496,467"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9ed2d9de7ef5353863fd334705cb7eb5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::loadAnonymousUser </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Loads anonymous user</p>
<p><a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a3d03923a8446b760aff8ddb4fb94c02d">loadUser()</a></p>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Implements <a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#aecad8186e1bcd0a7008938e7f319bb8d">eZ\Publish\API\Repository\UserService</a>.</p>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00594">594</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>

<p>References <a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a3d03923a8446b760aff8ddb4fb94c02d">eZ\Publish\API\Repository\UserService\loadUser()</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a3d03923a8446b760aff8ddb4fb94c02d">loadUser</a>( $this-&gt;settings[<span class="stringliteral">&#39;anonymousUserID&#39;</span>] );</div>
<div class="line">    }</div>
</div><!-- fragment -->
<p><div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a9ed2d9de7ef5353863fd334705cb7eb5_cgraph.png" border="0" usemap="#classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a9ed2d9de7ef5353863fd334705cb7eb5_cgraph" alt=""/></div>
<map name="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a9ed2d9de7ef5353863fd334705cb7eb5_cgraph" id="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a9ed2d9de7ef5353863fd334705cb7eb5_cgraph">
<area shape="rect" id="node3" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a3d03923a8446b760aff8ddb4fb94c02d" title="eZ\\Publish\\API\\Repository\l\\UserService\\loadUser" alt="" coords="295,5,476,51"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa2a87a46f1e4bff2cb48c578cf1bdc3a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::loadSubUserGroups </td>
          <td>(</td>
          <td class="paramtype">APIUserGroup&#160;</td>
          <td class="paramname"><em>$userGroup</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Loads the sub groups of a user group</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">\eZ\Publish\API\Repository\Values\User\UserGroup</td><td class="paramname">$userGroup</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[]</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\UnauthorizedException</td><td>if the authenticated user is not allowed to read the user group </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00176">176</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>

<p>References <a class="el" href="Core_2Repository_2UserService_8php_source.html#l01089">eZ\Publish\Core\Repository\UserService\buildDomainUserGroupObject()</a>, <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00157">eZ\Publish\Core\Repository\UserService\loadUserGroup()</a>, and <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00222">eZ\Publish\Core\Repository\UserService\searchSubGroups()</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> ( !is_numeric( $userGroup-&gt;id ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;id&quot;</span>, $userGroup-&gt;id, <span class="stringliteral">&quot;UserGroup&quot;</span> );</div>
<div class="line"></div>
<div class="line">        $locationService = $this-&gt;repository-&gt;getLocationService();</div>
<div class="line"></div>
<div class="line">        $loadedUserGroup = $this-&gt;<a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a640f9b85e0b2128e24ad696242b7b913">loadUserGroup</a>( $userGroup-&gt;id );</div>
<div class="line">        <span class="keywordflow">if</span> ( !$this-&gt;repository-&gt;canUser( <span class="stringliteral">&#39;content&#39;</span>, <span class="stringliteral">&#39;read&#39;</span>, $loadedUserGroup ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> UnauthorizedException( <span class="stringliteral">&#39;content&#39;</span>, <span class="stringliteral">&#39;read&#39;</span> );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( $loadedUserGroup-&gt;getVersionInfo()-&gt;getContentInfo()-&gt;mainLocationId === null )</div>
<div class="line">            <span class="keywordflow">return</span> array();</div>
<div class="line"></div>
<div class="line">        $mainGroupLocation = $locationService-&gt;loadLocation(</div>
<div class="line">            $loadedUserGroup-&gt;getVersionInfo()-&gt;getContentInfo()-&gt;mainLocationId</div>
<div class="line">        );</div>
<div class="line"></div>
<div class="line">        $searchResult = $this-&gt;<a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a2b8e691c232b069e519f3585aa718ae1">searchSubGroups</a>(</div>
<div class="line">            $mainGroupLocation-&gt;id,</div>
<div class="line">            $mainGroupLocation-&gt;sortField,</div>
<div class="line">            $mainGroupLocation-&gt;sortOrder</div>
<div class="line">        );</div>
<div class="line">        <span class="keywordflow">if</span> ( $searchResult-&gt;totalCount == 0 )</div>
<div class="line">            <span class="keywordflow">return</span> array();</div>
<div class="line"></div>
<div class="line">        $subUserGroups = array();</div>
<div class="line">        <span class="keywordflow">foreach</span> ( $searchResult-&gt;searchHits as $searchHit )</div>
<div class="line">        {</div>
<div class="line">            $subUserGroups[] = $this-&gt;<a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a076eaad098ee5bb939f0d71febc41daf">buildDomainUserGroupObject</a>( $searchHit-&gt;valueObject );</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> $subUserGroups;</div>
<div class="line">    }</div>
</div><!-- fragment -->
<p><div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_aa2a87a46f1e4bff2cb48c578cf1bdc3a_cgraph.png" border="0" usemap="#classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_aa2a87a46f1e4bff2cb48c578cf1bdc3a_cgraph" alt=""/></div>
<map name="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_aa2a87a46f1e4bff2cb48c578cf1bdc3a_cgraph" id="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_aa2a87a46f1e4bff2cb48c578cf1bdc3a_cgraph">
<area shape="rect" id="node3" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a076eaad098ee5bb939f0d71febc41daf" title="eZ\\Publish\\Core\\Repository\l\\UserService\\buildDomainUserGroup\lObject" alt="" coords="539,5,795,69"/><area shape="rect" id="node5" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a2b8e691c232b069e519f3585aa718ae1" title="eZ\\Publish\\Core\\Repository\l\\UserService\\searchSubGroups" alt="" coords="843,49,1064,95"/><area shape="rect" id="node9" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a640f9b85e0b2128e24ad696242b7b913" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadUserGroup" alt="" coords="288,23,491,70"/><area shape="rect" id="node7" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a941a732658a901463ed9fc76889a5a94" title="eZ\\Publish\\Core\\Repository\l\\UserService\\getSortClauseBySortField" alt="" coords="1112,49,1381,95"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab502862958e517ff3b17ac1a9c0d2cdf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::loadUserByCredentials </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$login</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Loads a user for the given login and password</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$login</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$password</td><td>the plain password</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\NotFoundException</td><td>if a user with the given credentials was not found </td></tr>
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\BadStateException</td><td>if multiple users with same login were found </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#aafc27835de6084481cebb4d6651519be">eZ\Publish\API\Repository\UserService</a>.</p>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00610">610</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>

<p>References <a class="el" href="Core_2Repository_2UserService_8php_source.html#l01121">eZ\Publish\Core\Repository\UserService\buildDomainUserObject()</a>, and <a class="el" href="Core_2Repository_2UserService_8php_source.html#l01149">eZ\Publish\Core\Repository\UserService\createPasswordHash()</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> ( !is_string( $login ) || empty( $login ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;login&quot;</span>, $login );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( !is_string( $password ) || empty( $password ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;password&quot;</span>, $password );</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Randomize login time to protect against timing attacks</span></div>
<div class="line">        usleep( mt_rand( 0, 30000 ) );</div>
<div class="line"></div>
<div class="line">        $spiUsers = $this-&gt;userHandler-&gt;loadByLogin( $login );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( empty( $spiUsers ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> NotFoundException( <span class="stringliteral">&quot;user&quot;</span>, $login );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( count( $spiUsers ) &gt; 1 )</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// something went wrong, we should not have more than one</span></div>
<div class="line">            <span class="comment">// user with the same login</span></div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> BadStateException( <span class="stringliteral">&quot;login&quot;</span>, <span class="stringliteral">&#39;found several users with same login&#39;</span> );</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $passwordHash = $this-&gt;<a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a6b54fb1ebb2122200a1c8bbe5e33fd28">createPasswordHash</a>(</div>
<div class="line">            $login,</div>
<div class="line">            $password,</div>
<div class="line">            $this-&gt;settings[<span class="stringliteral">&#39;siteName&#39;</span>],</div>
<div class="line">            $spiUsers[0]-&gt;hashAlgorithm</div>
<div class="line">        );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( $spiUsers[0]-&gt;passwordHash !== $passwordHash )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> NotFoundException( <span class="stringliteral">&quot;user&quot;</span>, $login );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#ac9e0e2bf0968246dbc9d4a27d8793ea8">buildDomainUserObject</a>( $spiUsers[0] );</div>
<div class="line">    }</div>
</div><!-- fragment -->
<p><div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_ab502862958e517ff3b17ac1a9c0d2cdf_cgraph.png" border="0" usemap="#classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_ab502862958e517ff3b17ac1a9c0d2cdf_cgraph" alt=""/></div>
<map name="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_ab502862958e517ff3b17ac1a9c0d2cdf_cgraph" id="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_ab502862958e517ff3b17ac1a9c0d2cdf_cgraph">
<area shape="rect" id="node3" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#ac9e0e2bf0968246dbc9d4a27d8793ea8" title="eZ\\Publish\\Core\\Repository\l\\UserService\\buildDomainUserObject" alt="" coords="307,5,565,51"/><area shape="rect" id="node5" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a6b54fb1ebb2122200a1c8bbe5e33fd28" title="eZ\\Publish\\Core\\Repository\l\\UserService\\createPasswordHash" alt="" coords="316,74,556,121"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a640f9b85e0b2128e24ad696242b7b913"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::loadUserGroup </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Loads a user group for the given id</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$id</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\UnauthorizedException</td><td>if the authenticated user is not allowed to create a user group </td></tr>
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\NotFoundException</td><td>if the user group with the given id was not found </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#acccfc81a6ca6d3972ecd7acd379d3f16">eZ\Publish\API\Repository\UserService</a>.</p>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00157">157</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>

<p>References <a class="el" href="Core_2Repository_2UserService_8php_source.html#l01089">eZ\Publish\Core\Repository\UserService\buildDomainUserGroupObject()</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> ( !is_numeric( $id ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;id&quot;</span>, $id );</div>
<div class="line"></div>
<div class="line">        $content = $this-&gt;repository-&gt;getContentService()-&gt;loadContent( $id );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a076eaad098ee5bb939f0d71febc41daf">buildDomainUserGroupObject</a>( $content );</div>
<div class="line">    }</div>
</div><!-- fragment -->
<p><div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a640f9b85e0b2128e24ad696242b7b913_cgraph.png" border="0" usemap="#classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a640f9b85e0b2128e24ad696242b7b913_cgraph" alt=""/></div>
<map name="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a640f9b85e0b2128e24ad696242b7b913_cgraph" id="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a640f9b85e0b2128e24ad696242b7b913_cgraph">
<area shape="rect" id="node3" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a076eaad098ee5bb939f0d71febc41daf" title="eZ\\Publish\\Core\\Repository\l\\UserService\\buildDomainUserGroup\lObject" alt="" coords="256,5,512,69"/><area shape="rect" id="node5" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a2b8e691c232b069e519f3585aa718ae1" title="eZ\\Publish\\Core\\Repository\l\\UserService\\searchSubGroups" alt="" coords="560,14,781,61"/><area shape="rect" id="node7" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a941a732658a901463ed9fc76889a5a94" title="eZ\\Publish\\Core\\Repository\l\\UserService\\getSortClauseBySortField" alt="" coords="829,14,1099,61"/></map>
</div>
</p>

<p><div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a640f9b85e0b2128e24ad696242b7b913_icgraph.png" border="0" usemap="#classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a640f9b85e0b2128e24ad696242b7b913_icgraph" alt=""/></div>
<map name="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a640f9b85e0b2128e24ad696242b7b913_icgraph" id="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a640f9b85e0b2128e24ad696242b7b913_icgraph">
<area shape="rect" id="node3" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a09da5eb27d9ade2238b8df42491853cb" title="eZ\\Publish\\Core\\Repository\l\\UserService\\createUserGroup" alt="" coords="296,5,512,51"/><area shape="rect" id="node5" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#aa2a87a46f1e4bff2cb48c578cf1bdc3a" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadSubUserGroups" alt="" coords="287,74,521,121"/><area shape="rect" id="node7" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a28e2e4dbf3d76102efac0a2209abf3eb" title="eZ\\Publish\\Core\\Repository\l\\UserService\\deleteUserGroup" alt="" coords="296,143,512,190"/><area shape="rect" id="node9" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#addc144cf645cef52c02e6044f9db4c03" title="eZ\\Publish\\Core\\Repository\l\\UserService\\moveUserGroup" alt="" coords="299,213,509,259"/><area shape="rect" id="node11" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a21c5eb1213cc039f4658bc0fc6fc9b1e" title="eZ\\Publish\\Core\\Repository\l\\UserService\\updateUserGroup" alt="" coords="293,282,515,329"/><area shape="rect" id="node13" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a98dc72cbdccfd6064ff30fbc919421ac" title="eZ\\Publish\\Core\\Repository\l\\UserService\\createUser" alt="" coords="308,351,500,398"/><area shape="rect" id="node15" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a75cfccd623857d4d756212d739cdb4c3" title="eZ\\Publish\\Core\\Repository\l\\UserService\\assignUserToUserGroup" alt="" coords="275,421,533,467"/><area shape="rect" id="node17" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#aa231a9aa436dd5d83748c3462aba558b" title="eZ\\Publish\\Core\\Repository\l\\UserService\\unAssignUserFromUserGroup" alt="" coords="256,490,552,537"/><area shape="rect" id="node19" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#ab5159472def04b88ae10b644a4aa819a" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadUsersOfUserGroup" alt="" coords="277,559,531,606"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aeeeeab77ab6e3b0dafdd8958ac54a5a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::loadUserGroupsOfUser </td>
          <td>(</td>
          <td class="paramtype">APIUser&#160;</td>
          <td class="paramname"><em>$user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Loads the user groups the user belongs to</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\UnauthorizedException</td><td>if the authenticated user is not allowed read the user or user group</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">\eZ\Publish\API\Repository\Values\User\User</td><td class="paramname">$user</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[] </dd></dl>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00909">909</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>

<p>References <a class="el" href="Core_2Repository_2UserService_8php_source.html#l01089">eZ\Publish\Core\Repository\UserService\buildDomainUserGroupObject()</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        $locationService = $this-&gt;repository-&gt;getLocationService();</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( !$this-&gt;repository-&gt;canUser( <span class="stringliteral">&#39;content&#39;</span>, <span class="stringliteral">&#39;edit&#39;</span>, $user ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> UnauthorizedException( <span class="stringliteral">&#39;content&#39;</span>, <span class="stringliteral">&#39;edit&#39;</span> );</div>
<div class="line"></div>
<div class="line">        $userLocations = $locationService-&gt;loadLocations(</div>
<div class="line">            $user-&gt;getVersionInfo()-&gt;getContentInfo()</div>
<div class="line">        );</div>
<div class="line"></div>
<div class="line">        $parentLocationIds = array();</div>
<div class="line">        <span class="keywordflow">foreach</span> ( $userLocations as $userLocation )</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> ( $userLocation-&gt;parentLocationId !== null )</div>
<div class="line">                $parentLocationIds[] = $userLocation-&gt;parentLocationId;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $searchQuery = <span class="keyword">new</span> Query();</div>
<div class="line"></div>
<div class="line">        $searchQuery-&gt;offset = 0;</div>
<div class="line">        $searchQuery-&gt;limit = null;</div>
<div class="line"></div>
<div class="line">        $searchQuery-&gt;criterion = <span class="keyword">new</span> CriterionLogicalAnd(</div>
<div class="line">            array(</div>
<div class="line">                <span class="keyword">new</span> CriterionContentTypeId( $this-&gt;settings[<span class="stringliteral">&#39;userGroupClassID&#39;</span>] ),</div>
<div class="line">                <span class="keyword">new</span> CriterionLocationId( $parentLocationIds ),</div>
<div class="line">                <span class="keyword">new</span> CriterionStatus( CriterionStatus::STATUS_PUBLISHED )</div>
<div class="line">            )</div>
<div class="line">        );</div>
<div class="line"></div>
<div class="line">        $searchResult = $this-&gt;repository-&gt;getSearchService()-&gt;findContent( $searchQuery, array() );</div>
<div class="line"></div>
<div class="line">        $userGroups = array();</div>
<div class="line">        <span class="keywordflow">foreach</span> ( $searchResult-&gt;searchHits as $resultItem )</div>
<div class="line">        {</div>
<div class="line">            $userGroups[] = $this-&gt;<a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a076eaad098ee5bb939f0d71febc41daf">buildDomainUserGroupObject</a>( $resultItem-&gt;valueObject );</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> $userGroups;</div>
<div class="line">    }</div>
</div><!-- fragment -->
<p><div id="dynsection-17" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_aeeeeab77ab6e3b0dafdd8958ac54a5a2_cgraph.png" border="0" usemap="#classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_aeeeeab77ab6e3b0dafdd8958ac54a5a2_cgraph" alt=""/></div>
<map name="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_aeeeeab77ab6e3b0dafdd8958ac54a5a2_cgraph" id="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_aeeeeab77ab6e3b0dafdd8958ac54a5a2_cgraph">
<area shape="rect" id="node3" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a076eaad098ee5bb939f0d71febc41daf" title="eZ\\Publish\\Core\\Repository\l\\UserService\\buildDomainUserGroup\lObject" alt="" coords="309,5,565,69"/><area shape="rect" id="node5" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a2b8e691c232b069e519f3585aa718ae1" title="eZ\\Publish\\Core\\Repository\l\\UserService\\searchSubGroups" alt="" coords="613,14,835,61"/><area shape="rect" id="node7" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a941a732658a901463ed9fc76889a5a94" title="eZ\\Publish\\Core\\Repository\l\\UserService\\getSortClauseBySortField" alt="" coords="883,14,1152,61"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab5159472def04b88ae10b644a4aa819a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::loadUsersOfUserGroup </td>
          <td>(</td>
          <td class="paramtype">APIUserGroup&#160;</td>
          <td class="paramname"><em>$userGroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$offset</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$limit</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Loads the users of a user group</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\UnauthorizedException</td><td>if the authenticated user is not allowed to read the users or user group</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">\eZ\Publish\API\Repository\Values\User\UserGroup</td><td class="paramname">$userGroup</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$offset</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$limit</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[] </dd></dl>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00962">962</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>

<p>References <a class="el" href="Core_2Repository_2UserService_8php_source.html#l01121">eZ\Publish\Core\Repository\UserService\buildDomainUserObject()</a>, <a class="el" href="Core_2Repository_2UserService_8php_source.html#l01178">eZ\Publish\Core\Repository\UserService\getSortClauseBySortField()</a>, and <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00157">eZ\Publish\Core\Repository\UserService\loadUserGroup()</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        $loadedUserGroup = $this-&gt;<a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a640f9b85e0b2128e24ad696242b7b913">loadUserGroup</a>( $userGroup-&gt;id );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( $loadedUserGroup-&gt;getVersionInfo()-&gt;getContentInfo()-&gt;mainLocationId === null )</div>
<div class="line">            <span class="keywordflow">return</span> array();</div>
<div class="line"></div>
<div class="line">        $mainGroupLocation = $this-&gt;repository-&gt;getLocationService()-&gt;loadLocation(</div>
<div class="line">            $loadedUserGroup-&gt;getVersionInfo()-&gt;getContentInfo()-&gt;mainLocationId</div>
<div class="line">        );</div>
<div class="line"></div>
<div class="line">        $searchQuery = <span class="keyword">new</span> Query();</div>
<div class="line"></div>
<div class="line">        $searchQuery-&gt;criterion = <span class="keyword">new</span> CriterionLogicalAnd(</div>
<div class="line">            array(</div>
<div class="line">                <span class="keyword">new</span> CriterionContentTypeId( $this-&gt;settings[<span class="stringliteral">&#39;userClassID&#39;</span>] ),</div>
<div class="line">                <span class="keyword">new</span> CriterionParentLocationId( $mainGroupLocation-&gt;id ),</div>
<div class="line">                <span class="keyword">new</span> CriterionStatus( CriterionStatus::STATUS_PUBLISHED )</div>
<div class="line">            )</div>
<div class="line">        );</div>
<div class="line"></div>
<div class="line">        $searchQuery-&gt;offset = $offset &gt; 0 ? (int)$offset : 0;</div>
<div class="line">        $searchQuery-&gt;limit = $limit &gt;= 1 ? (int)$limit : null;</div>
<div class="line"></div>
<div class="line">        $searchQuery-&gt;sortClauses = array(</div>
<div class="line">            $this-&gt;<a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a941a732658a901463ed9fc76889a5a94">getSortClauseBySortField</a>( $mainGroupLocation-&gt;sortField, $mainGroupLocation-&gt;sortOrder )</div>
<div class="line">        );</div>
<div class="line"></div>
<div class="line">        $searchResult = $this-&gt;repository-&gt;getSearchService()-&gt;findContent( $searchQuery, array() );</div>
<div class="line"></div>
<div class="line">        $users = array();</div>
<div class="line">        <span class="keywordflow">foreach</span> ( $searchResult-&gt;searchHits as $resultItem )</div>
<div class="line">        {</div>
<div class="line">            $spiUser = $this-&gt;userHandler-&gt;load( $resultItem-&gt;valueObject-&gt;id );</div>
<div class="line"></div>
<div class="line">            $users[] = $this-&gt;<a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#ac9e0e2bf0968246dbc9d4a27d8793ea8">buildDomainUserObject</a>( $spiUser, $resultItem-&gt;valueObject );</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> $users;</div>
<div class="line">    }</div>
</div><!-- fragment -->
<p><div id="dynsection-18" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_ab5159472def04b88ae10b644a4aa819a_cgraph.png" border="0" usemap="#classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_ab5159472def04b88ae10b644a4aa819a_cgraph" alt=""/></div>
<map name="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_ab5159472def04b88ae10b644a4aa819a_cgraph" id="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_ab5159472def04b88ae10b644a4aa819a_cgraph">
<area shape="rect" id="node3" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#ac9e0e2bf0968246dbc9d4a27d8793ea8" title="eZ\\Publish\\Core\\Repository\l\\UserService\\buildDomainUserObject" alt="" coords="309,5,568,51"/><area shape="rect" id="node5" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a941a732658a901463ed9fc76889a5a94" title="eZ\\Publish\\Core\\Repository\l\\UserService\\getSortClauseBySortField" alt="" coords="1189,97,1459,143"/><area shape="rect" id="node7" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a640f9b85e0b2128e24ad696242b7b913" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadUserGroup" alt="" coords="337,129,540,175"/><area shape="rect" id="node9" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a076eaad098ee5bb939f0d71febc41daf" title="eZ\\Publish\\Core\\Repository\l\\UserService\\buildDomainUserGroup\lObject" alt="" coords="616,125,872,189"/><area shape="rect" id="node11" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a2b8e691c232b069e519f3585aa718ae1" title="eZ\\Publish\\Core\\Repository\l\\UserService\\searchSubGroups" alt="" coords="920,129,1141,175"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="addc144cf645cef52c02e6044f9db4c03"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::moveUserGroup </td>
          <td>(</td>
          <td class="paramtype">APIUserGroup&#160;</td>
          <td class="paramname"><em>$userGroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">APIUserGroup&#160;</td>
          <td class="paramname"><em>$newParent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Moves the user group to another parent</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">\eZ\Publish\API\Repository\Values\User\UserGroup</td><td class="paramname">$userGroup</td><td></td></tr>
    <tr><td class="paramtype">\eZ\Publish\API\Repository\Values\User\UserGroup</td><td class="paramname">$newParent</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\UnauthorizedException</td><td>if the authenticated user is not allowed to move the user group </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00284">284</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>

<p>References <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00157">eZ\Publish\Core\Repository\UserService\loadUserGroup()</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> ( !is_numeric( $userGroup-&gt;id ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;id&quot;</span>, $userGroup-&gt;id, <span class="stringliteral">&quot;UserGroup&quot;</span> );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( !is_numeric( $newParent-&gt;id ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;id&quot;</span>, $newParent-&gt;id, <span class="stringliteral">&quot;UserGroup&quot;</span> );</div>
<div class="line"></div>
<div class="line">        $loadedUserGroup = $this-&gt;<a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a640f9b85e0b2128e24ad696242b7b913">loadUserGroup</a>( $userGroup-&gt;id );</div>
<div class="line">        $loadedNewParent = $this-&gt;<a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a640f9b85e0b2128e24ad696242b7b913">loadUserGroup</a>( $newParent-&gt;id );</div>
<div class="line"></div>
<div class="line">        $locationService = $this-&gt;repository-&gt;getLocationService();</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( $loadedUserGroup-&gt;getVersionInfo()-&gt;getContentInfo()-&gt;mainLocationId === null )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> BadStateException( <span class="stringliteral">&quot;userGroup&quot;</span>, <span class="stringliteral">&#39;existing user group is not stored and/or does not have any location yet&#39;</span> );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( $loadedNewParent-&gt;getVersionInfo()-&gt;getContentInfo()-&gt;mainLocationId === null )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> BadStateException( <span class="stringliteral">&quot;newParent&quot;</span>, <span class="stringliteral">&#39;new user group is not stored and/or does not have any location yet&#39;</span> );</div>
<div class="line"></div>
<div class="line">        $userGroupMainLocation = $locationService-&gt;loadLocation(</div>
<div class="line">            $loadedUserGroup-&gt;getVersionInfo()-&gt;getContentInfo()-&gt;mainLocationId</div>
<div class="line">        );</div>
<div class="line">        $newParentMainLocation = $locationService-&gt;loadLocation(</div>
<div class="line">            $loadedNewParent-&gt;getVersionInfo()-&gt;getContentInfo()-&gt;mainLocationId</div>
<div class="line">        );</div>
<div class="line"></div>
<div class="line">        $this-&gt;repository-&gt;beginTransaction();</div>
<div class="line">        <span class="keywordflow">try</span></div>
<div class="line">        {</div>
<div class="line">            $locationService-&gt;moveSubtree( $userGroupMainLocation, $newParentMainLocation );</div>
<div class="line">            $this-&gt;repository-&gt;commit();</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span> ( \Exception $e )</div>
<div class="line">        {</div>
<div class="line">            $this-&gt;repository-&gt;rollback();</div>
<div class="line">            <span class="keywordflow">throw</span> $e;</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment -->
<p><div id="dynsection-19" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_addc144cf645cef52c02e6044f9db4c03_cgraph.png" border="0" usemap="#classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_addc144cf645cef52c02e6044f9db4c03_cgraph" alt=""/></div>
<map name="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_addc144cf645cef52c02e6044f9db4c03_cgraph" id="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_addc144cf645cef52c02e6044f9db4c03_cgraph">
<area shape="rect" id="node3" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a640f9b85e0b2128e24ad696242b7b913" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadUserGroup" alt="" coords="267,14,469,61"/><area shape="rect" id="node5" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a076eaad098ee5bb939f0d71febc41daf" title="eZ\\Publish\\Core\\Repository\l\\UserService\\buildDomainUserGroup\lObject" alt="" coords="517,5,773,69"/><area shape="rect" id="node7" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a2b8e691c232b069e519f3585aa718ae1" title="eZ\\Publish\\Core\\Repository\l\\UserService\\searchSubGroups" alt="" coords="821,14,1043,61"/><area shape="rect" id="node9" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a941a732658a901463ed9fc76889a5a94" title="eZ\\Publish\\Core\\Repository\l\\UserService\\getSortClauseBySortField" alt="" coords="1091,14,1360,61"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1a13a3dd3743d8277b50076eef6c5f3e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::newUserCreateStruct </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$login</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$email</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$mainLanguageCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$contentType</em> = <code>null</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Instantiate a user create class</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$login</td><td>the login of the new user </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$email</td><td>the email of the new user </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$password</td><td>the plain password of the new user </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$mainLanguageCode</td><td>the main language for the underlying content object </td></tr>
    <tr><td class="paramtype">\eZ\Publish\API\Repository\Values\ContentType\ContentType</td><td class="paramname">$contentType</td><td>5.x the content type for the underlying content object. In 4.x it is ignored and taken from the configuration</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Implements <a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a1843a2c279173653b8346afdba9a9ca1">eZ\Publish\API\Repository\UserService</a>.</p>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l01014">1014</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> ( $contentType === null )</div>
<div class="line">        {</div>
<div class="line">            $contentType = $this-&gt;repository-&gt;getContentTypeService()-&gt;loadContentType(</div>
<div class="line">                $this-&gt;settings[<span class="stringliteral">&#39;userClassID&#39;</span>]</div>
<div class="line">            );</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">new</span> UserCreateStruct(</div>
<div class="line">            array(</div>
<div class="line">                <span class="stringliteral">&#39;contentType&#39;</span> =&gt; $contentType,</div>
<div class="line">                <span class="stringliteral">&#39;mainLanguageCode&#39;</span> =&gt; $mainLanguageCode,</div>
<div class="line">                <span class="stringliteral">&#39;login&#39;</span> =&gt; $login,</div>
<div class="line">                <span class="stringliteral">&#39;email&#39;</span> =&gt; $email,</div>
<div class="line">                <span class="stringliteral">&#39;password&#39;</span> =&gt; $password,</div>
<div class="line">                <span class="stringliteral">&#39;enabled&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line">                <span class="stringliteral">&#39;fields&#39;</span> =&gt; array(),</div>
<div class="line">            )</div>
<div class="line">        );</div>
<div class="line">    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1567c0abf56cf3cfb7ceee93006d801d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::newUserGroupCreateStruct </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$mainLanguageCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$contentType</em> = <code>null</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Instantiate a user group create class</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$mainLanguageCode</td><td>The main language for the underlying content object </td></tr>
    <tr><td class="paramtype">null&#160;|&#160;\eZ\Publish\API\Repository\Values\ContentType\ContentType</td><td class="paramname">$contentType</td><td>5.x the content type for the underlying content object. In 4.x it is ignored and taken from the configuration</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Implements <a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a9b11ff0703b71be530bdd273d61675f9">eZ\Publish\API\Repository\UserService</a>.</p>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l01044">1044</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> ( $contentType === null )</div>
<div class="line">        {</div>
<div class="line">            $contentType = $this-&gt;repository-&gt;getContentTypeService()-&gt;loadContentType(</div>
<div class="line">                $this-&gt;settings[<span class="stringliteral">&#39;userGroupClassID&#39;</span>]</div>
<div class="line">            );</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">new</span> UserGroupCreateStruct(</div>
<div class="line">            array(</div>
<div class="line">                <span class="stringliteral">&#39;contentType&#39;</span> =&gt; $contentType,</div>
<div class="line">                <span class="stringliteral">&#39;mainLanguageCode&#39;</span> =&gt; $mainLanguageCode,</div>
<div class="line">                <span class="stringliteral">&#39;fields&#39;</span> =&gt; array(),</div>
<div class="line">            )</div>
<div class="line">        );</div>
<div class="line">    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aba42580de9875f30ec2765db35f82e00"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::newUserGroupUpdateStruct </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Instantiate a new user group update struct</p>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Implements <a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a04cbf8c4861ece814ae21b1b54bc5974">eZ\Publish\API\Repository\UserService</a>.</p>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l01077">1077</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">new</span> UserGroupUpdateStruct();</div>
<div class="line">    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a16bbf0876764d14cf59cbe82ece2bcb4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::newUserUpdateStruct </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Instantiate a new user update struct</p>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Implements <a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a997da39ea99818a3de8a48f5f767da05">eZ\Publish\API\Repository\UserService</a>.</p>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l01067">1067</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">new</span> UserUpdateStruct();</div>
<div class="line">    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2b8e691c232b069e519f3585aa718ae1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::searchSubGroups </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$locationId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$sortField</em> = <code>null</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$sortOrder</em> = <code><a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1Content_1_1Location.html#a9f40b7c4819bf471456c80c2a4958fb4">Location::SORT_ORDER_ASC</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$offset</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$limit</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns (searches) subgroups of a user group described by its main location</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">int</td><td class="paramname">$locationId</td><td></td></tr>
    <tr><td class="paramtype">int&#160;|&#160;null</td><td class="paramname">$sortField</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$sortOrder</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$offset</td><td></td></tr>
    <tr><td class="paramtype">int</td><td class="paramname">$limit</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00222">222</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>

<p>References <a class="el" href="Core_2Repository_2UserService_8php_source.html#l01178">eZ\Publish\Core\Repository\UserService\getSortClauseBySortField()</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        $searchQuery = <span class="keyword">new</span> Query();</div>
<div class="line"></div>
<div class="line">        $searchQuery-&gt;offset = $offset &gt;= 0 ? (int)$offset : 0;</div>
<div class="line">        $searchQuery-&gt;limit = $limit &gt;= 0 ? (int)$limit  : null;</div>
<div class="line"></div>
<div class="line">        $searchQuery-&gt;criterion = <span class="keyword">new</span> CriterionLogicalAnd(</div>
<div class="line">            array(</div>
<div class="line">                <span class="keyword">new</span> CriterionContentTypeId( $this-&gt;settings[<span class="stringliteral">&#39;userGroupClassID&#39;</span>] ),</div>
<div class="line">                <span class="keyword">new</span> CriterionParentLocationId( $locationId ),</div>
<div class="line">                <span class="keyword">new</span> CriterionStatus( CriterionStatus::STATUS_PUBLISHED )</div>
<div class="line">            )</div>
<div class="line">        );</div>
<div class="line"></div>
<div class="line">        $sortClause = null;</div>
<div class="line">        <span class="keywordflow">if</span> ( $sortField !== null )</div>
<div class="line">            $sortClause = array( $this-&gt;<a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a941a732658a901463ed9fc76889a5a94">getSortClauseBySortField</a>( $sortField, $sortOrder ) );</div>
<div class="line"></div>
<div class="line">        $searchQuery-&gt;sortClauses = $sortClause;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> $this-&gt;repository-&gt;getSearchService()-&gt;findContent( $searchQuery, array(), <span class="keyword">false</span> );</div>
<div class="line">    }</div>
</div><!-- fragment -->
<p><div id="dynsection-20" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a2b8e691c232b069e519f3585aa718ae1_cgraph.png" border="0" usemap="#classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a2b8e691c232b069e519f3585aa718ae1_cgraph" alt=""/></div>
<map name="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a2b8e691c232b069e519f3585aa718ae1_cgraph" id="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a2b8e691c232b069e519f3585aa718ae1_cgraph">
<area shape="rect" id="node3" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a941a732658a901463ed9fc76889a5a94" title="eZ\\Publish\\Core\\Repository\l\\UserService\\getSortClauseBySortField" alt="" coords="275,5,544,51"/></map>
</div>
</p>

<p><div id="dynsection-21" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-21-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-21-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-21-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a2b8e691c232b069e519f3585aa718ae1_icgraph.png" border="0" usemap="#classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a2b8e691c232b069e519f3585aa718ae1_icgraph" alt=""/></div>
<map name="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a2b8e691c232b069e519f3585aa718ae1_icgraph" id="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a2b8e691c232b069e519f3585aa718ae1_icgraph">
<area shape="rect" id="node3" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#aa2a87a46f1e4bff2cb48c578cf1bdc3a" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadSubUserGroups" alt="" coords="913,5,1148,51"/><area shape="rect" id="node5" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a076eaad098ee5bb939f0d71febc41daf" title="eZ\\Publish\\Core\\Repository\l\\UserService\\buildDomainUserGroup\lObject" alt="" coords="275,308,531,372"/><area shape="rect" id="node7" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a09da5eb27d9ade2238b8df42491853cb" title="eZ\\Publish\\Core\\Repository\l\\UserService\\createUserGroup" alt="" coords="923,559,1139,606"/><area shape="rect" id="node9" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a640f9b85e0b2128e24ad696242b7b913" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadUserGroup" alt="" coords="605,282,808,329"/><area shape="rect" id="node17" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a21c5eb1213cc039f4658bc0fc6fc9b1e" title="eZ\\Publish\\Core\\Repository\l\\UserService\\updateUserGroup" alt="" coords="920,490,1141,537"/><area shape="rect" id="node29" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#aeeeeab77ab6e3b0dafdd8958ac54a5a2" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadUserGroupsOfUser" alt="" coords="580,351,833,398"/><area shape="rect" id="node13" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a28e2e4dbf3d76102efac0a2209abf3eb" title="eZ\\Publish\\Core\\Repository\l\\UserService\\deleteUserGroup" alt="" coords="923,143,1139,190"/><area shape="rect" id="node15" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#addc144cf645cef52c02e6044f9db4c03" title="eZ\\Publish\\Core\\Repository\l\\UserService\\moveUserGroup" alt="" coords="925,213,1136,259"/><area shape="rect" id="node19" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a98dc72cbdccfd6064ff30fbc919421ac" title="eZ\\Publish\\Core\\Repository\l\\UserService\\createUser" alt="" coords="935,282,1127,329"/><area shape="rect" id="node21" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a75cfccd623857d4d756212d739cdb4c3" title="eZ\\Publish\\Core\\Repository\l\\UserService\\assignUserToUserGroup" alt="" coords="901,351,1160,398"/><area shape="rect" id="node23" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#aa231a9aa436dd5d83748c3462aba558b" title="eZ\\Publish\\Core\\Repository\l\\UserService\\unAssignUserFromUserGroup" alt="" coords="883,421,1179,467"/><area shape="rect" id="node25" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#ab5159472def04b88ae10b644a4aa819a" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadUsersOfUserGroup" alt="" coords="904,74,1157,121"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa231a9aa436dd5d83748c3462aba558b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::unAssignUserFromUserGroup </td>
          <td>(</td>
          <td class="paramtype">APIUser&#160;</td>
          <td class="paramname"><em>$user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">APIUserGroup&#160;</td>
          <td class="paramname"><em>$userGroup</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Removes a user group from the user</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">\eZ\Publish\API\Repository\Values\User\User</td><td class="paramname">$user</td><td></td></tr>
    <tr><td class="paramtype">\eZ\Publish\API\Repository\Values\User\UserGroup</td><td class="paramname">$userGroup</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\UnauthorizedException</td><td>if the authenticated user is not allowed to remove the user group from the user </td></tr>
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\InvalidArgumentException</td><td>if the user is not in the given user group </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00859">859</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>

<p>References <a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a3d03923a8446b760aff8ddb4fb94c02d">eZ\Publish\API\Repository\UserService\loadUser()</a>, and <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00157">eZ\Publish\Core\Repository\UserService\loadUserGroup()</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> ( !is_numeric( $user-&gt;id ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;id&quot;</span>, $user-&gt;id, <span class="stringliteral">&quot;User&quot;</span> );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( !is_numeric( $userGroup-&gt;id ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;id&quot;</span>, $userGroup-&gt;id, <span class="stringliteral">&quot;UserGroup&quot;</span> );</div>
<div class="line"></div>
<div class="line">        $loadedUser = $this-&gt;<a class="code" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a3d03923a8446b760aff8ddb4fb94c02d">loadUser</a>( $user-&gt;id );</div>
<div class="line">        $loadedGroup = $this-&gt;<a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a640f9b85e0b2128e24ad696242b7b913">loadUserGroup</a>( $userGroup-&gt;id );</div>
<div class="line">        $locationService = $this-&gt;repository-&gt;getLocationService();</div>
<div class="line"></div>
<div class="line">        $userLocations = $locationService-&gt;loadLocations( $loadedUser-&gt;getVersionInfo()-&gt;getContentInfo() );</div>
<div class="line">        <span class="keywordflow">if</span> ( empty( $userLocations ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> BadStateException( <span class="stringliteral">&quot;user&quot;</span>, <span class="stringliteral">&quot;user has no locations, cannot unassign from group&quot;</span> );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( $loadedGroup-&gt;getVersionInfo()-&gt;getContentInfo()-&gt;mainLocationId === null )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> BadStateException( <span class="stringliteral">&quot;userGroup&quot;</span>, <span class="stringliteral">&quot;user group has no main location or no locations, cannot unassign&quot;</span> );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">foreach</span> ( $userLocations as $userLocation )</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> ( $userLocation-&gt;parentLocationId == $loadedGroup-&gt;getVersionInfo()-&gt;getContentInfo()-&gt;mainLocationId )</div>
<div class="line">            {</div>
<div class="line">                $this-&gt;repository-&gt;beginTransaction();</div>
<div class="line">                <span class="keywordflow">try</span></div>
<div class="line">                {</div>
<div class="line">                    $locationService-&gt;deleteLocation( $userLocation );</div>
<div class="line">                    $this-&gt;repository-&gt;commit();</div>
<div class="line">                    <span class="keywordflow">return</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">catch</span> ( \Exception $e )</div>
<div class="line">                {</div>
<div class="line">                    $this-&gt;repository-&gt;rollback();</div>
<div class="line">                    <span class="keywordflow">throw</span> $e;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentException( <span class="stringliteral">&quot;userGroup&quot;</span>, <span class="stringliteral">&quot;user is not in the given user group&quot;</span> );</div>
<div class="line">    }</div>
</div><!-- fragment -->
<p><div id="dynsection-22" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-22-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-22-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-22-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_aa231a9aa436dd5d83748c3462aba558b_cgraph.png" border="0" usemap="#classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_aa231a9aa436dd5d83748c3462aba558b_cgraph" alt=""/></div>
<map name="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_aa231a9aa436dd5d83748c3462aba558b_cgraph" id="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_aa231a9aa436dd5d83748c3462aba558b_cgraph">
<area shape="rect" id="node3" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a3d03923a8446b760aff8ddb4fb94c02d" title="eZ\\Publish\\API\\Repository\l\\UserService\\loadUser" alt="" coords="360,5,541,51"/><area shape="rect" id="node5" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a640f9b85e0b2128e24ad696242b7b913" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadUserGroup" alt="" coords="349,74,552,121"/><area shape="rect" id="node7" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a076eaad098ee5bb939f0d71febc41daf" title="eZ\\Publish\\Core\\Repository\l\\UserService\\buildDomainUserGroup\lObject" alt="" coords="600,65,856,129"/><area shape="rect" id="node9" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a2b8e691c232b069e519f3585aa718ae1" title="eZ\\Publish\\Core\\Repository\l\\UserService\\searchSubGroups" alt="" coords="904,74,1125,121"/><area shape="rect" id="node11" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a941a732658a901463ed9fc76889a5a94" title="eZ\\Publish\\Core\\Repository\l\\UserService\\getSortClauseBySortField" alt="" coords="1173,74,1443,121"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="adee23ecc6d6f3eec627b8967f55318a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::updateUser </td>
          <td>(</td>
          <td class="paramtype">APIUser&#160;</td>
          <td class="paramname"><em>$user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1User_1_1UserUpdateStruct.html">UserUpdateStruct</a>&#160;</td>
          <td class="paramname"><em>$userUpdateStruct</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Updates a user</p>
<p>4.x: If the versionUpdateStruct is set in the user update structure, this method internally creates a content draft, updates ts with the provided data and publishes the draft. If a draft is explicitly required, the user group can be updated via the content service methods.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">\eZ\Publish\API\Repository\Values\User\User</td><td class="paramname">$user</td><td></td></tr>
    <tr><td class="paramtype">\eZ\Publish\API\Repository\Values\User\UserUpdateStruct</td><td class="paramname">$userUpdateStruct</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\UnauthorizedException</td><td>if the authenticated user is not allowed to update the user </td></tr>
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\ContentFieldValidationException</td><td>if a field in the $userUpdateStruct is not valid </td></tr>
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\ContentValidationException</td><td>if a required field is set empty</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00688">688</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>

<p>References <a class="el" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a3d03923a8446b760aff8ddb4fb94c02d">eZ\Publish\API\Repository\UserService\loadUser()</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> ( !is_numeric( $user-&gt;id ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;id&quot;</span>, $user-&gt;id, <span class="stringliteral">&quot;User&quot;</span> );</div>
<div class="line"></div>
<div class="line">        <span class="comment">// We need to determine if we have anything to update.</span></div>
<div class="line">        <span class="comment">// UserUpdateStruct is specific as some of the new content is in</span></div>
<div class="line">        <span class="comment">// content update struct and some of it is in additional fields like</span></div>
<div class="line">        <span class="comment">// email, password and so on</span></div>
<div class="line">        $doUpdate = <span class="keyword">false</span>;</div>
<div class="line">        <span class="keywordflow">foreach</span> ( $userUpdateStruct as $propertyValue )</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> ( $propertyValue !== null )</div>
<div class="line">            {</div>
<div class="line">                $doUpdate = <span class="keyword">true</span>;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( !$doUpdate )</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// Nothing to update, so we just quit</span></div>
<div class="line">            <span class="keywordflow">return</span> $user;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( $userUpdateStruct-&gt;email !== null )</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> ( !is_string( $userUpdateStruct-&gt;email ) || empty( $userUpdateStruct-&gt;email ) )</div>
<div class="line">                <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;email&quot;</span>, $userUpdateStruct-&gt;email, <span class="stringliteral">&quot;UserUpdateStruct&quot;</span> );</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> ( !ezcMailTools::validateEmailAddress( $userUpdateStruct-&gt;email ) )</div>
<div class="line">                <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;email&quot;</span>, $userUpdateStruct-&gt;email, <span class="stringliteral">&quot;UserUpdateStruct&quot;</span> );</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( $userUpdateStruct-&gt;password !== null &amp;&amp; ( !is_string( $userUpdateStruct-&gt;password ) || empty( $userUpdateStruct-&gt;password ) ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;password&quot;</span>, $userUpdateStruct-&gt;password, <span class="stringliteral">&quot;UserUpdateStruct&quot;</span> );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( $userUpdateStruct-&gt;enabled !== null &amp;&amp; !is_bool( $userUpdateStruct-&gt;enabled ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;enabled&quot;</span>, $userUpdateStruct-&gt;enabled, <span class="stringliteral">&quot;UserUpdateStruct&quot;</span> );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( $userUpdateStruct-&gt;maxLogin !== null &amp;&amp; !is_numeric( $userUpdateStruct-&gt;maxLogin ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;maxLogin&quot;</span>, $userUpdateStruct-&gt;maxLogin, <span class="stringliteral">&quot;UserUpdateStruct&quot;</span> );</div>
<div class="line"></div>
<div class="line">        $contentService = $this-&gt;repository-&gt;getContentService();</div>
<div class="line">        $loadedUser = $this-&gt;<a class="code" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a3d03923a8446b760aff8ddb4fb94c02d">loadUser</a>( $user-&gt;id );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( !$this-&gt;repository-&gt;canUser( <span class="stringliteral">&#39;content&#39;</span>, <span class="stringliteral">&#39;edit&#39;</span>, $loadedUser ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> UnauthorizedException( <span class="stringliteral">&#39;content&#39;</span>, <span class="stringliteral">&#39;edit&#39;</span> );</div>
<div class="line"></div>
<div class="line">        $this-&gt;repository-&gt;beginTransaction();</div>
<div class="line">        <span class="keywordflow">try</span></div>
<div class="line">        {</div>
<div class="line">            $publishedContent = $loadedUser;</div>
<div class="line">            <span class="keywordflow">if</span> ( $userUpdateStruct-&gt;contentUpdateStruct !== null )</div>
<div class="line">            {</div>
<div class="line">                $contentDraft = $contentService-&gt;createContentDraft( $loadedUser-&gt;getVersionInfo()-&gt;getContentInfo() );</div>
<div class="line">                $contentDraft = $contentService-&gt;updateContent(</div>
<div class="line">                    $contentDraft-&gt;getVersionInfo(),</div>
<div class="line">                    $userUpdateStruct-&gt;contentUpdateStruct</div>
<div class="line">                );</div>
<div class="line">                $publishedContent = $contentService-&gt;publishVersion( $contentDraft-&gt;getVersionInfo() );</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> ( $userUpdateStruct-&gt;contentMetadataUpdateStruct !== null )</div>
<div class="line">            {</div>
<div class="line">                $contentService-&gt;updateContentMetadata(</div>
<div class="line">                    $publishedContent-&gt;getVersionInfo()-&gt;getContentInfo(),</div>
<div class="line">                    $userUpdateStruct-&gt;contentMetadataUpdateStruct</div>
<div class="line">                );</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            $this-&gt;userHandler-&gt;update(</div>
<div class="line">                <span class="keyword">new</span> SPIUser(</div>
<div class="line">                    array(</div>
<div class="line">                        <span class="stringliteral">&#39;id&#39;</span> =&gt; $loadedUser-&gt;id,</div>
<div class="line">                        <span class="stringliteral">&#39;login&#39;</span> =&gt; $loadedUser-&gt;login,</div>
<div class="line">                        <span class="stringliteral">&#39;email&#39;</span> =&gt; $userUpdateStruct-&gt;email ?: $loadedUser-&gt;email,</div>
<div class="line">                        <span class="stringliteral">&#39;passwordHash&#39;</span> =&gt; $userUpdateStruct-&gt;password ?</div>
<div class="line">                            $this-&gt;createPasswordHash(</div>
<div class="line">                                $loadedUser-&gt;login,</div>
<div class="line">                                $userUpdateStruct-&gt;password,</div>
<div class="line">                                $this-&gt;settings[<span class="stringliteral">&#39;siteName&#39;</span>],</div>
<div class="line">                                $this-&gt;settings[<span class="stringliteral">&#39;hashType&#39;</span>]</div>
<div class="line">                            ) :</div>
<div class="line">                            $loadedUser-&gt;passwordHash,</div>
<div class="line">                        <span class="stringliteral">&#39;hashAlgorithm&#39;</span> =&gt; $this-&gt;settings[<span class="stringliteral">&#39;hashType&#39;</span>],</div>
<div class="line">                        <span class="stringliteral">&#39;isEnabled&#39;</span> =&gt; $userUpdateStruct-&gt;enabled !== null ? $userUpdateStruct-&gt;enabled : $loadedUser-&gt;enabled,</div>
<div class="line">                        <span class="stringliteral">&#39;maxLogin&#39;</span> =&gt; $userUpdateStruct-&gt;maxLogin !== null ? (int)$userUpdateStruct-&gt;maxLogin : $loadedUser-&gt;maxLogin</div>
<div class="line">                    )</div>
<div class="line">                )</div>
<div class="line">            );</div>
<div class="line"></div>
<div class="line">            $this-&gt;repository-&gt;commit();</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span> ( \Exception $e )</div>
<div class="line">        {</div>
<div class="line">            $this-&gt;repository-&gt;rollback();</div>
<div class="line">            <span class="keywordflow">throw</span> $e;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a3d03923a8446b760aff8ddb4fb94c02d">loadUser</a>( $loadedUser-&gt;id );</div>
<div class="line">    }</div>
</div><!-- fragment -->
<p><div id="dynsection-23" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-23-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-23-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-23-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_adee23ecc6d6f3eec627b8967f55318a3_cgraph.png" border="0" usemap="#classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_adee23ecc6d6f3eec627b8967f55318a3_cgraph" alt=""/></div>
<map name="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_adee23ecc6d6f3eec627b8967f55318a3_cgraph" id="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_adee23ecc6d6f3eec627b8967f55318a3_cgraph">
<area shape="rect" id="node3" href="interfaceeZ_1_1Publish_1_1API_1_1Repository_1_1UserService.html#a3d03923a8446b760aff8ddb4fb94c02d" title="eZ\\Publish\\API\\Repository\l\\UserService\\loadUser" alt="" coords="249,5,431,51"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a21c5eb1213cc039f4658bc0fc6fc9b1e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::updateUserGroup </td>
          <td>(</td>
          <td class="paramtype">APIUserGroup&#160;</td>
          <td class="paramname"><em>$userGroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classeZ_1_1Publish_1_1API_1_1Repository_1_1Values_1_1User_1_1UserGroupUpdateStruct.html">UserGroupUpdateStruct</a>&#160;</td>
          <td class="paramname"><em>$userGroupUpdateStruct</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Updates the group profile with fields and meta data</p>
<p>4.x: If the versionUpdateStruct is set in $userGroupUpdateStruct, this method internally creates a content draft, updates ts with the provided data and publishes the draft. If a draft is explicitly required, the user group can be updated via the content service methods.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">\eZ\Publish\API\Repository\Values\User\UserGroup</td><td class="paramname">$userGroup</td><td></td></tr>
    <tr><td class="paramtype">\eZ\Publish\API\Repository\Values\User\UserGroupUpdateStruct</td><td class="paramname">$userGroupUpdateStruct</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\UnauthorizedException</td><td>if the authenticated user is not allowed to update the user group </td></tr>
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\ContentFieldValidationException</td><td>if a field in the $userGroupUpdateStruct is not valid </td></tr>
    <tr><td class="paramname">\eZ\Publish\API\Repository\Exceptions\ContentValidationException</td><td>if a required field is set empty </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00338">338</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>

<p>References <a class="el" href="Core_2Repository_2UserService_8php_source.html#l01089">eZ\Publish\Core\Repository\UserService\buildDomainUserGroupObject()</a>, and <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00157">eZ\Publish\Core\Repository\UserService\loadUserGroup()</a>.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> ( !is_numeric( $userGroup-&gt;id ) )</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> InvalidArgumentValue( <span class="stringliteral">&quot;id&quot;</span>, $userGroup-&gt;id, <span class="stringliteral">&quot;UserGroup&quot;</span> );</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( $userGroupUpdateStruct-&gt;contentUpdateStruct === null &amp;&amp;</div>
<div class="line">            $userGroupUpdateStruct-&gt;contentMetadataUpdateStruct === null )</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// both update structs are empty, nothing to do</span></div>
<div class="line">            <span class="keywordflow">return</span> $userGroup;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        $contentService = $this-&gt;repository-&gt;getContentService();</div>
<div class="line"></div>
<div class="line">        $loadedUserGroup = $this-&gt;<a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a640f9b85e0b2128e24ad696242b7b913">loadUserGroup</a>( $userGroup-&gt;id );</div>
<div class="line"></div>
<div class="line">        $this-&gt;repository-&gt;beginTransaction();</div>
<div class="line">        <span class="keywordflow">try</span></div>
<div class="line">        {</div>
<div class="line">            $publishedContent = $loadedUserGroup;</div>
<div class="line">            <span class="keywordflow">if</span> ( $userGroupUpdateStruct-&gt;contentUpdateStruct !== null )</div>
<div class="line">            {</div>
<div class="line">                $contentDraft = $contentService-&gt;createContentDraft( $loadedUserGroup-&gt;getVersionInfo()-&gt;getContentInfo() );</div>
<div class="line"></div>
<div class="line">                $contentDraft = $contentService-&gt;updateContent(</div>
<div class="line">                    $contentDraft-&gt;getVersionInfo(),</div>
<div class="line">                    $userGroupUpdateStruct-&gt;contentUpdateStruct</div>
<div class="line">                );</div>
<div class="line"></div>
<div class="line">                $publishedContent = $contentService-&gt;publishVersion( $contentDraft-&gt;getVersionInfo() );</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> ( $userGroupUpdateStruct-&gt;contentMetadataUpdateStruct !== null )</div>
<div class="line">            {</div>
<div class="line">                $publishedContent = $contentService-&gt;updateContentMetadata(</div>
<div class="line">                    $publishedContent-&gt;getVersionInfo()-&gt;getContentInfo(),</div>
<div class="line">                    $userGroupUpdateStruct-&gt;contentMetadataUpdateStruct</div>
<div class="line">                );</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            $this-&gt;repository-&gt;commit();</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span> ( \Exception $e )</div>
<div class="line">        {</div>
<div class="line">            $this-&gt;repository-&gt;rollback();</div>
<div class="line">            <span class="keywordflow">throw</span> $e;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a076eaad098ee5bb939f0d71febc41daf">buildDomainUserGroupObject</a>( $publishedContent );</div>
<div class="line">    }</div>
</div><!-- fragment -->
<p><div id="dynsection-24" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-24-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-24-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-24-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a21c5eb1213cc039f4658bc0fc6fc9b1e_cgraph.png" border="0" usemap="#classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a21c5eb1213cc039f4658bc0fc6fc9b1e_cgraph" alt=""/></div>
<map name="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a21c5eb1213cc039f4658bc0fc6fc9b1e_cgraph" id="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService_a21c5eb1213cc039f4658bc0fc6fc9b1e_cgraph">
<area shape="rect" id="node3" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a076eaad098ee5bb939f0d71febc41daf" title="eZ\\Publish\\Core\\Repository\l\\UserService\\buildDomainUserGroup\lObject" alt="" coords="525,5,781,69"/><area shape="rect" id="node9" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a640f9b85e0b2128e24ad696242b7b913" title="eZ\\Publish\\Core\\Repository\l\\UserService\\loadUserGroup" alt="" coords="275,43,477,90"/><area shape="rect" id="node5" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a2b8e691c232b069e519f3585aa718ae1" title="eZ\\Publish\\Core\\Repository\l\\UserService\\searchSubGroups" alt="" coords="829,14,1051,61"/><area shape="rect" id="node7" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html#a941a732658a901463ed9fc76889a5a94" title="eZ\\Publish\\Core\\Repository\l\\UserService\\getSortClauseBySortField" alt="" coords="1099,14,1368,61"/></map>
</div>
</p>

</div>
</div>
<h2>Member Data Documentation</h2>
<a class="anchor" id="adc99fa4080a886ba5681ed62bb7f2574"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::$repository</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00056">56</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>

</div>
</div>
<a class="anchor" id="a1214c914e64f779d7fc75258f4476890"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::$settings</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00066">66</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>

</div>
</div>
<a class="anchor" id="a529de19efac12c3532aeb96f27e757af"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">eZ\Publish\Core\Repository\UserService::$userHandler</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="Core_2Repository_2UserService_8php_source.html#l00061">61</a> of file <a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/var/lib/jenkins/jobs/PAPI-doxygen-master/workspace/eZ/Publish/Core/Repository/<a class="el" href="Core_2Repository_2UserService_8php_source.html">UserService.php</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceeZ.html">eZ</a></li><li class="navelem"><a class="el" href="namespaceeZ_1_1Publish.html">Publish</a></li><li class="navelem"><a class="el" href="namespaceeZ_1_1Publish_1_1Core.html">Core</a></li><li class="navelem"><a class="el" href="namespaceeZ_1_1Publish_1_1Core_1_1Repository.html">Repository</a></li><li class="navelem"><a class="el" href="classeZ_1_1Publish_1_1Core_1_1Repository_1_1UserService.html">UserService</a></li>
    <li class="footer">Generated on Tue Dec 25 2012 00:02:43 for ezp-next by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1.2 </li>
  </ul>
</div>
</body>
</html>
